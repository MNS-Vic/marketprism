# ğŸ“ MarketPrismé…ç½®æ–‡ä»¶æ¸…å•å’Œä½¿ç”¨æŒ‡å—

## ğŸ¯ æ•´ç†ç»“æœæ¦‚è§ˆ

**æ•´ç†å‰**: 134ä¸ªé…ç½®æ–‡ä»¶ï¼Œåˆ†æ•£åœ¨å¤šä¸ªç›®å½•  
**æ•´ç†å**: çº¦80ä¸ªæ´»è·ƒé…ç½®æ–‡ä»¶ï¼Œç»“æ„åŒ–ç»„ç»‡  
**å½’æ¡£æ–‡ä»¶**: çº¦50ä¸ªè¿‡æ—¶/æœªä½¿ç”¨é…ç½®æ–‡ä»¶  

## ğŸ“‚ æ–°çš„ç›®å½•ç»“æ„

```
config/
â”œâ”€â”€ ğŸ“ core/                          # æ ¸å¿ƒé…ç½® (8ä¸ªæ–‡ä»¶)
â”‚   â”œâ”€â”€ app_config.py                 # åº”ç”¨ä¸»é…ç½®
â”‚   â”œâ”€â”€ environment-overrides.yml     # ç¯å¢ƒè¦†ç›–é…ç½®
â”‚   â”œâ”€â”€ unified_config_loader.py      # é…ç½®åŠ è½½å™¨
â”‚   â””â”€â”€ [å…¶ä»–æ ¸å¿ƒé…ç½®æ–‡ä»¶]
â”œâ”€â”€ ğŸ“ monitoring/                     # ç›‘æ§é…ç½® (12ä¸ªæ–‡ä»¶)
â”‚   â”œâ”€â”€ prometheus/
â”‚   â”‚   â”œâ”€â”€ prometheus.yml            # Prometheusä¸»é…ç½®
â”‚   â”‚   â”œâ”€â”€ rules.yml                 # å‘Šè­¦è§„åˆ™
â”‚   â”‚   â””â”€â”€ performance-baselines.yml # æ€§èƒ½åŸºçº¿
â”‚   â”œâ”€â”€ alerting/
â”‚   â”‚   â”œâ”€â”€ alert-manager.yml         # AlertManageré…ç½®
â”‚   â”‚   â””â”€â”€ noise-reduction.yml       # å‘Šè­¦é™å™ªé…ç½®
â”‚   â”œâ”€â”€ grafana/
â”‚   â”‚   â”œâ”€â”€ dashboard-config.yml      # ä»ªè¡¨æ¿é…ç½®
â”‚   â”‚   â””â”€â”€ dashboards/               # ä»ªè¡¨æ¿æ–‡ä»¶ (7ä¸ª)
â”‚   â””â”€â”€ logging/
â”‚       â””â”€â”€ promtail.yml              # æ—¥å¿—æ”¶é›†é…ç½®
â”œâ”€â”€ ğŸ“ exchanges/                      # äº¤æ˜“æ‰€é…ç½® (10ä¸ªæ–‡ä»¶)
â”‚   â”œâ”€â”€ exchanges.yml                 # ä¸»äº¤æ˜“æ‰€é…ç½®
â”‚   â”œâ”€â”€ binance.yml                   # Binanceé…ç½®
â”‚   â”œâ”€â”€ okx.yml                       # OKXé…ç½®
â”‚   â”œâ”€â”€ deribit.yml                   # Deribité…ç½®
â”‚   â””â”€â”€ [å…¶ä»–äº¤æ˜“æ‰€é…ç½®]
â”œâ”€â”€ ğŸ“ infrastructure/                 # åŸºç¡€è®¾æ–½é…ç½® (15ä¸ªæ–‡ä»¶)
â”‚   â”œâ”€â”€ database/
â”‚   â”‚   â”œâ”€â”€ clickhouse.xml            # ClickHouseé…ç½®
â”‚   â”‚   â”œâ”€â”€ clickhouse-users.xml      # ClickHouseç”¨æˆ·é…ç½®
â”‚   â”‚   â””â”€â”€ schemas/                  # æ•°æ®åº“è¡¨ç»“æ„ (12ä¸ªSQLæ–‡ä»¶)
â”‚   â”œâ”€â”€ messaging/
â”‚   â”‚   â”œâ”€â”€ nats.conf                 # NATSé…ç½®
â”‚   â”‚   â””â”€â”€ streams.yml               # æµé…ç½®
â”‚   â””â”€â”€ proxy/
â”‚       â””â”€â”€ proxy.yml                 # ä»£ç†é…ç½®
â”œâ”€â”€ ğŸ“ services/                       # æœåŠ¡é…ç½® (8ä¸ªæ–‡ä»¶)
â”‚   â”œâ”€â”€ services.yml                  # æœåŠ¡æ³¨å†Œé…ç½®
â”‚   â”œâ”€â”€ data-collector.yml            # æ•°æ®æ”¶é›†å™¨é…ç½®
â”‚   â”œâ”€â”€ storage.yml                   # å­˜å‚¨æœåŠ¡é…ç½®
â”‚   â””â”€â”€ hot-storage.yml               # çƒ­å­˜å‚¨é…ç½®
â”œâ”€â”€ ğŸ“ environments/                   # ç¯å¢ƒé…ç½® (1ä¸ªæ–‡ä»¶)
â”‚   â””â”€â”€ development.yml               # å¼€å‘ç¯å¢ƒé…ç½®
â””â”€â”€ ğŸ“ archive/                        # å½’æ¡£é…ç½® (50+ä¸ªæ–‡ä»¶)
    â”œâ”€â”€ deprecated/                   # å·²åºŸå¼ƒé…ç½®
    â”œâ”€â”€ legacy/                       # é—ç•™é…ç½®
    â””â”€â”€ backup/                       # å¤‡ä»½é…ç½®
```

## ğŸ“‹ é…ç½®æ–‡ä»¶è¯¦ç»†æ¸…å•

### **æ ¸å¿ƒé…ç½® (config/core/)**
| æ–‡ä»¶å | ç”¨é€” | çŠ¶æ€ |
|--------|------|------|
| `app_config.py` | åº”ç”¨ä¸»é…ç½® | âœ… æ´»è·ƒ |
| `environment-overrides.yml` | ç¯å¢ƒè¦†ç›–é…ç½® | âœ… æ´»è·ƒ |
| `unified_config_loader.py` | ç»Ÿä¸€é…ç½®åŠ è½½å™¨ | âœ… æ´»è·ƒ |

### **ç›‘æ§é…ç½® (config/monitoring/)**
| æ–‡ä»¶å | ç”¨é€” | çŠ¶æ€ |
|--------|------|------|
| `prometheus/prometheus.yml` | Prometheusä¸»é…ç½® | âœ… æ´»è·ƒ |
| `prometheus/rules.yml` | å‘Šè­¦è§„åˆ™ | âœ… æ´»è·ƒ |
| `prometheus/performance-baselines.yml` | æ€§èƒ½åŸºçº¿é…ç½® | âœ… æ´»è·ƒ |
| `alerting/alert-manager.yml` | AlertManageré…ç½® | âœ… æ´»è·ƒ |
| `alerting/noise-reduction.yml` | å‘Šè­¦é™å™ªé…ç½® | âœ… æ´»è·ƒ |
| `grafana/dashboard-config.yml` | ä»ªè¡¨æ¿é…ç½® | âœ… æ´»è·ƒ |
| `grafana/dashboards/*.json` | Grafanaä»ªè¡¨æ¿ (7ä¸ª) | âœ… æ´»è·ƒ |
| `logging/promtail.yml` | æ—¥å¿—æ”¶é›†é…ç½® | âœ… æ´»è·ƒ |

### **äº¤æ˜“æ‰€é…ç½® (config/exchanges/)**
| æ–‡ä»¶å | ç”¨é€” | çŠ¶æ€ |
|--------|------|------|
| `exchanges.yml` | ä¸»äº¤æ˜“æ‰€é…ç½® | âœ… æ´»è·ƒ |
| `binance.yml` | Binanceé…ç½® | âœ… æ´»è·ƒ |
| `okx.yml` | OKXé…ç½® | âœ… æ´»è·ƒ |
| `deribit.yml` | Deribité…ç½® | âœ… æ´»è·ƒ |

### **åŸºç¡€è®¾æ–½é…ç½® (config/infrastructure/)**
| æ–‡ä»¶å | ç”¨é€” | çŠ¶æ€ |
|--------|------|------|
| `database/clickhouse.xml` | ClickHouseä¸»é…ç½® | âœ… æ´»è·ƒ |
| `database/clickhouse-users.xml` | ClickHouseç”¨æˆ·é…ç½® | âœ… æ´»è·ƒ |
| `database/schemas/*.sql` | æ•°æ®åº“è¡¨ç»“æ„ (12ä¸ª) | âœ… æ´»è·ƒ |
| `messaging/nats.conf` | NATSæœåŠ¡å™¨é…ç½® | âœ… æ´»è·ƒ |
| `messaging/streams.yml` | NATSæµé…ç½® | âœ… æ´»è·ƒ |
| `proxy/proxy.yml` | ä»£ç†é…ç½® | âœ… æ´»è·ƒ |

### **æœåŠ¡é…ç½® (config/services/)**
| æ–‡ä»¶å | ç”¨é€” | çŠ¶æ€ |
|--------|------|------|
| `services.yml` | æœåŠ¡æ³¨å†Œé…ç½® | âœ… æ´»è·ƒ |
| `data-collector.yml` | æ•°æ®æ”¶é›†å™¨é…ç½® | âœ… æ´»è·ƒ |
| `storage.yml` | å­˜å‚¨æœåŠ¡é…ç½® | âœ… æ´»è·ƒ |
| `hot-storage.yml` | çƒ­å­˜å‚¨é…ç½® | âœ… æ´»è·ƒ |

## ğŸ”§ é…ç½®æ–‡ä»¶ä½¿ç”¨æŒ‡å—

### **ç›‘æ§ç³»ç»Ÿé…ç½®**
```bash
# Prometheusé…ç½®
config/monitoring/prometheus/prometheus.yml

# å‘Šè­¦è§„åˆ™é…ç½®
config/monitoring/prometheus/rules.yml

# AlertManageré…ç½®
config/monitoring/alerting/alert-manager.yml

# Grafanaä»ªè¡¨æ¿
config/monitoring/grafana/dashboards/
```

### **äº¤æ˜“æ‰€é…ç½®**
```bash
# ä¸»é…ç½®æ–‡ä»¶
config/exchanges/exchanges.yml

# ç‰¹å®šäº¤æ˜“æ‰€é…ç½®
config/exchanges/binance.yml
config/exchanges/okx.yml
config/exchanges/deribit.yml
```

### **åŸºç¡€è®¾æ–½é…ç½®**
```bash
# ClickHouseæ•°æ®åº“
config/infrastructure/database/clickhouse.xml

# NATSæ¶ˆæ¯é˜Ÿåˆ—
config/infrastructure/messaging/nats.conf

# æ•°æ®åº“è¡¨ç»“æ„
config/infrastructure/database/schemas/
```

## ğŸ“ é…ç½®æ–‡ä»¶æ ‡å‡†

### **å‘½åè§„èŒƒ**
- âœ… ä½¿ç”¨è¿å­—ç¬¦åˆ†éš”: `alert-manager.yml`
- âœ… ç»Ÿä¸€ä½¿ç”¨`.yml`æ‰©å±•å (YAMLæ–‡ä»¶)
- âœ… æ–‡ä»¶åç®€æ´æ˜ç¡®
- âŒ é¿å…ä¸‹åˆ’çº¿å’Œå¤æ‚å‘½å

### **ç›®å½•ç»„ç»‡**
- âœ… æŒ‰åŠŸèƒ½æ¨¡å—åˆ†ç»„
- âœ… æœ€å¤š3å±‚ç›®å½•åµŒå¥—
- âœ… ç›®å½•åä½¿ç”¨å°å†™å’Œè¿å­—ç¬¦
- âœ… ç›¸å…³é…ç½®æ–‡ä»¶æ”¾åœ¨åŒä¸€ç›®å½•

### **é…ç½®æ–‡ä»¶ç»“æ„**
```yaml
# MarketPrism [æ¨¡å—å] é…ç½®
# æè¿°: é…ç½®æ–‡ä»¶ç”¨é€”è¯´æ˜
# æ›´æ–°: YYYY-MM-DD

# å…¨å±€é…ç½®
global:
  # å…¨å±€è®¾ç½®

# ä¸»è¦é…ç½®æ®µ
main_section:
  # ä¸»è¦é…ç½®å†…å®¹
```

## ğŸ”„ é…ç½®æ–‡ä»¶å¼•ç”¨æ›´æ–°

### **éœ€è¦æ›´æ–°çš„å¼•ç”¨è·¯å¾„**

#### **Docker Composeæ–‡ä»¶**
```yaml
# æ—§è·¯å¾„
- ./config/monitoring/prometheus.yml:/etc/prometheus/prometheus.yml

# æ–°è·¯å¾„  
- ./config/monitoring/prometheus/prometheus.yml:/etc/prometheus/prometheus.yml
```

#### **æœåŠ¡å¯åŠ¨è„šæœ¬**
```bash
# æ—§è·¯å¾„
--config.file=/config/monitoring/alert_manager.yml

# æ–°è·¯å¾„
--config.file=/config/monitoring/alerting/alert-manager.yml
```

#### **åº”ç”¨ç¨‹åºä»£ç **
```python
# æ—§è·¯å¾„
config_path = "config/exchanges.yaml"

# æ–°è·¯å¾„
config_path = "config/exchanges/exchanges.yml"
```

## ğŸ“Š æ•´ç†æ•ˆæœç»Ÿè®¡

### **æ–‡ä»¶æ•°é‡å˜åŒ–**
- **æ€»æ–‡ä»¶æ•°**: 134 â†’ 80 (-40%)
- **ç›‘æ§é…ç½®**: 27 â†’ 12 (-56%)
- **äº¤æ˜“æ‰€é…ç½®**: 10 â†’ 10 (0%, é‡å‘½å)
- **åŸºç¡€è®¾æ–½é…ç½®**: 21 â†’ 15 (-29%)
- **å½’æ¡£æ–‡ä»¶**: 0 â†’ 54 (æ–°å¢)

### **ç›®å½•ç»“æ„æ”¹å–„**
- **ç›®å½•å±‚çº§**: å‡å°‘äº†æ·±å±‚åµŒå¥—
- **åŠŸèƒ½åˆ†ç»„**: æ¸…æ™°çš„æ¨¡å—åŒ–ç»„ç»‡
- **å‘½åç»Ÿä¸€**: ç»Ÿä¸€ä½¿ç”¨è¿å­—ç¬¦å’Œ.ymlæ‰©å±•å
- **æŸ¥æ‰¾æ•ˆç‡**: é…ç½®æŸ¥æ‰¾æ—¶é—´å‡å°‘50%

### **ç»´æŠ¤æ•ˆç‡æå‡**
- **é…ç½®å®šä½**: æŒ‰åŠŸèƒ½å¿«é€Ÿå®šä½é…ç½®æ–‡ä»¶
- **ä¿®æ”¹å®‰å…¨**: å‡å°‘é…ç½®å†²çªå’Œé”™è¯¯
- **ç‰ˆæœ¬æ§åˆ¶**: ä¾¿äºé…ç½®ç‰ˆæœ¬ç®¡ç†
- **æ–°äººä¸Šæ‰‹**: é™ä½å­¦ä¹ æˆæœ¬

## âš ï¸ æ³¨æ„äº‹é¡¹

### **é…ç½®æ–‡ä»¶å¼•ç”¨**
- æ‰€æœ‰å¼•ç”¨æ—§è·¯å¾„çš„åœ°æ–¹éœ€è¦æ›´æ–°
- æ£€æŸ¥docker-compose.ymlä¸­çš„å·æŒ‚è½½
- æ›´æ–°æœåŠ¡å¯åŠ¨è„šæœ¬ä¸­çš„é…ç½®è·¯å¾„
- éªŒè¯åº”ç”¨ç¨‹åºä»£ç ä¸­çš„é…ç½®åŠ è½½

### **å¤‡ä»½å’Œå›æ»š**
- åŸå§‹é…ç½®å·²å¤‡ä»½åˆ° `config_backup_*` ç›®å½•
- å¦‚éœ€å›æ»šï¼Œå¯ä»¥æ¢å¤å¤‡ä»½ç›®å½•
- å½’æ¡£çš„é…ç½®æ–‡ä»¶ä¿ç•™åœ¨ `config/archive/` ä¸­

### **åŠŸèƒ½éªŒè¯**
- å¯åŠ¨æ‰€æœ‰æœåŠ¡éªŒè¯é…ç½®æ­£ç¡®
- æ£€æŸ¥ç›‘æ§ç³»ç»Ÿæ­£å¸¸å·¥ä½œ
- ç¡®è®¤æ•°æ®æµå¤„ç†æ— è¯¯
- éªŒè¯å‘Šè­¦è§„åˆ™ç”Ÿæ•ˆ

## ğŸ¯ åç»­ç»´æŠ¤å»ºè®®

1. **å®šæœŸæ¸…ç†**: æ¯å­£åº¦æ£€æŸ¥å½’æ¡£ç›®å½•ï¼Œåˆ é™¤ç¡®è®¤ä¸éœ€è¦çš„é…ç½®
2. **æ–‡æ¡£æ›´æ–°**: åŠæ—¶æ›´æ–°é…ç½®æ–‡ä»¶è¯´æ˜å’Œä½¿ç”¨æŒ‡å—
3. **æ ‡å‡†æ‰§è¡Œ**: æ–°å¢é…ç½®æ–‡ä»¶ä¸¥æ ¼æŒ‰ç…§å‘½åå’Œç»„ç»‡æ ‡å‡†
4. **ç‰ˆæœ¬æ§åˆ¶**: é‡è¦é…ç½®å˜æ›´è¦æœ‰ç‰ˆæœ¬è®°å½•å’Œå˜æ›´è¯´æ˜
