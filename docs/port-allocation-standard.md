# MarketPrism ç«¯å£åˆ†é…æ ‡å‡†

## ğŸ¯ ç«¯å£åˆ†é…åŸåˆ™

### 1. åˆ†æ®µç®¡ç†
- **8080-8089**: æ ¸å¿ƒä¸šåŠ¡æœåŠ¡
- **8090-8099**: æ”¯æŒæœåŠ¡å’Œå·¥å…·
- **9000-9099**: ç›‘æ§å’Œç®¡ç†æœåŠ¡
- **4000-4999**: æ¶ˆæ¯é˜Ÿåˆ—å’Œæ•°æ®åº“
- **3000-3999**: å‰ç«¯å’ŒUIæœåŠ¡

### 2. å‘½åè§„èŒƒ
- æ¯ä¸ªæœåŠ¡åªèƒ½å ç”¨ä¸€ä¸ªä¸»ç«¯å£
- ç«¯å£å·ä¸æœåŠ¡åŠŸèƒ½ç›¸å…³è”
- é¿å…éšæ„åˆ†é…ï¼Œéµå¾ªç»Ÿä¸€æ ‡å‡†

## ğŸ“‹ æ ‡å‡†ç«¯å£åˆ†é…è¡¨

### æ ¸å¿ƒä¸šåŠ¡æœåŠ¡ (8080-8089)
| ç«¯å£ | æœåŠ¡åç§° | æœåŠ¡ID | åŠŸèƒ½æè¿° |
|------|----------|--------|----------|
| 8080 | API Gateway | api-gateway-service | APIç½‘å…³å’Œè·¯ç”± |
| 8081 | é¢„ç•™ | - | æ ¸å¿ƒä¸šåŠ¡æ‰©å±• |
| 8082 | Monitoring Alerting | monitoring-alerting-service | ç›‘æ§å‘Šè­¦æœåŠ¡ |
| 8083 | Data Storage | data-storage-service | æ•°æ®å­˜å‚¨æœåŠ¡ |
| 8084 | Data Collector | data-collector | æ•°æ®æ”¶é›†æœåŠ¡ |
| 8085 | é¢„ç•™ | - | æ ¸å¿ƒä¸šåŠ¡æ‰©å±• |
| 8086 | Message Broker | message-broker-service | æ¶ˆæ¯ä»£ç†æœåŠ¡ |
| 8087 | Data Storage Hot | data-storage-hot-service | çƒ­æ•°æ®å­˜å‚¨æœåŠ¡ |
| 8088-8089 | é¢„ç•™ | - | æ ¸å¿ƒä¸šåŠ¡æ‰©å±• |

### æ”¯æŒæœåŠ¡ (8090-8099)
| ç«¯å£ | æœåŠ¡åç§° | æœåŠ¡ID | åŠŸèƒ½æè¿° |
|------|----------|--------|----------|
| 8090 | Task Worker | task-worker-service | ä»»åŠ¡å·¥ä½œè€… |
| 8091-8099 | é¢„ç•™ | - | æ”¯æŒæœåŠ¡æ‰©å±• |
| 8093 | é¢„ç•™ | - | æ”¯æŒæœåŠ¡æ‰©å±• |
| 8094 | é¢„ç•™ | - | æ”¯æŒæœåŠ¡æ‰©å±• |
| 8095 | é¢„ç•™ | - | æ”¯æŒæœåŠ¡æ‰©å±• |
| 8096 | é¢„ç•™ | - | æ”¯æŒæœåŠ¡æ‰©å±• |
| 8097 | é¢„ç•™ | - | æ”¯æŒæœåŠ¡æ‰©å±• |
| 8098 | é¢„ç•™ | - | æ”¯æŒæœåŠ¡æ‰©å±• |
| 8099 | é¢„ç•™ | - | æ”¯æŒæœåŠ¡æ‰©å±• |

### ç›‘æ§ç®¡ç†æœåŠ¡ (9000-9099)
| ç«¯å£ | æœåŠ¡åç§° | æœåŠ¡ID | åŠŸèƒ½æè¿° |
|------|----------|--------|----------|
| 9000-9089 | é¢„ç•™ | - | ç›‘æ§æœåŠ¡æ‰©å±• |
| 9090 | Prometheus | prometheus | æŒ‡æ ‡æ”¶é›† |
| 9091 | Grafana | grafana | å¯è§†åŒ–é¢æ¿ |
| 9092 | é¢„ç•™ | - | ç›‘æ§æœåŠ¡æ‰©å±• |

### åŸºç¡€è®¾æ–½æœåŠ¡ (4000-4999)
| ç«¯å£ | æœåŠ¡åç§° | æœåŠ¡ID | åŠŸèƒ½æè¿° |
|------|----------|--------|----------|
| 4222 | NATS | nats | æ¶ˆæ¯é˜Ÿåˆ— |
| 4223 | NATS Monitoring | nats-monitoring | NATSç›‘æ§ |
| 5432 | PostgreSQL | postgres | å…³ç³»æ•°æ®åº“ |
| 6379 | Redis | redis | ç¼“å­˜æ•°æ®åº“ |
| 8123 | ClickHouse HTTP | clickhouse | æ—¶åºæ•°æ®åº“HTTP |
| 9000 | ClickHouse TCP | clickhouse | æ—¶åºæ•°æ®åº“TCP |

### å‰ç«¯UIæœåŠ¡ (3000-3999)
| ç«¯å£ | æœåŠ¡åç§° | æœåŠ¡ID | åŠŸèƒ½æè¿° |
|------|----------|--------|----------|
| 3000 | Market Prism Dashboard | market-prism-dashboard | ä¸»è¦UIç•Œé¢ |
| 3001 | Admin Dashboard | admin-dashboard | ç®¡ç†ç•Œé¢ |
| 3002 | é¢„ç•™ | - | UIæœåŠ¡æ‰©å±• |

## ğŸ”§ ç«¯å£å†²çªè§£å†³æ–¹æ¡ˆ

### å½“å‰å†²çªä¿®å¤
1. **monitoring-service**: 8082 â†’ 9000
2. **monitoring-dashboard**: 8086 â†’ 9001
3. **strategy-management**: 8087 â†’ 8086
4. **data-migration-service**: ä¿æŒ8087 â†’ 8087

### å®æ–½æ­¥éª¤
1. æ›´æ–° `config/services.yaml` é…ç½®
2. æ›´æ–° `docker-compose.yml` ç«¯å£æ˜ å°„
3. æ›´æ–°å„æœåŠ¡çš„Dockerfile EXPOSEæŒ‡ä»¤
4. æ›´æ–°å¥åº·æ£€æŸ¥å’ŒæœåŠ¡å‘ç°é…ç½®
5. æ›´æ–°æ–‡æ¡£å’Œéƒ¨ç½²è„šæœ¬

## ğŸ“ ç«¯å£åˆ†é…è§„åˆ™

### åˆ†é…æ–°ç«¯å£æ—¶
1. æŸ¥é˜…æ­¤æ–‡æ¡£ç¡®è®¤ç«¯å£å¯ç”¨æ€§
2. æŒ‰ç…§æœåŠ¡ç±»å‹é€‰æ‹©å¯¹åº”ç«¯å£æ®µ
3. æ›´æ–°æ­¤æ–‡æ¡£è®°å½•æ–°åˆ†é…
4. æ›´æ–°ç›¸å…³é…ç½®æ–‡ä»¶

### ç«¯å£å†²çªæ£€æµ‹
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tlnp | grep :8080

# æ£€æŸ¥Dockerå®¹å™¨ç«¯å£
docker ps --format "table {{.Names}}\t{{.Ports}}"

# æ£€æŸ¥é…ç½®æ–‡ä»¶å†²çª
grep -r "port.*8080" config/
```

## ğŸš€ è‡ªåŠ¨åŒ–å·¥å…·

### ç«¯å£å†²çªæ£€æµ‹è„šæœ¬
```bash
#!/bin/bash
# scripts/check-port-conflicts.sh
echo "æ£€æŸ¥MarketPrismç«¯å£å†²çª..."
grep -r "port:" config/services.yaml | sort | uniq -d
```

### ç«¯å£åˆ†é…éªŒè¯
```bash
#!/bin/bash
# scripts/validate-port-allocation.sh
echo "éªŒè¯ç«¯å£åˆ†é…æ ‡å‡†åˆè§„æ€§..."
# å®ç°ç«¯å£åˆ†é…éªŒè¯é€»è¾‘
```

## ğŸ“¡ ç›‘æ§æ ˆç«¯å£ä¸ç‹¬ç«‹æŒ‡æ ‡ç«¯å£ï¼ˆç°è¡Œçº¦å®šï¼‰
- Prometheus: 9090
- Alertmanager: 9093
- Grafana: 3000

- Collector Metrics: 9092
- Hot Storage Metrics: 9094
- Cold Storage Metrics: 9095
- Message Broker Metrics: 9096

è¯´æ˜ï¼šå¦‚é‡ç«¯å£å ç”¨ï¼Œå¿…é¡»å…ˆ kill å ç”¨è¿›ç¨‹ï¼Œä¸å¾—éšæ„ä¿®æ”¹ç«¯å£å·ã€‚


---

**éµå¾ªæ­¤æ ‡å‡†å¯ä»¥ç¡®ä¿MarketPrismç³»ç»Ÿçš„ç«¯å£åˆ†é…æ¸…æ™°ã€æœ‰åºã€æ— å†²çªã€‚**
