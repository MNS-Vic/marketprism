# MarketPrism 项目清理整理计划

**创建时间**: 2025-05-24  
**任务类型**: 项目维护和重构  
**复杂度**: Level 2-3 (中等复杂度)

---

## 🎯 清理目标

1. **消除冗余文件**: 删除无用的临时文件、备份文件、重复文件
2. **规范目录结构**: 建立清晰的文件组织体系
3. **配置文件统一管理**: 集中管理所有配置文件
4. **模块使用情况盘点**: 识别未使用或废弃的模块
5. **优化项目体积**: 减少不必要的存储占用

---

## 📊 项目现状问题

### 🚨 主要问题
- **临时文件**: 20+ .bak/.old/.tmp文件
- **配置分散**: 30+配置文件分布在多个目录
- **Docker过多**: 26个Dockerfile + 8个docker-compose
- **根目录混乱**: 48个脚本和文档文件
- **日志堆积**: 346MB日志文件
- **重复文件**: 81.7MB压缩包重复

### 📈 目录大小分析
```
798M    data           # 数据目录 (可能包含测试数据)
346M    logs           # 日志目录 (需要清理)
 77M    marketprism.zip # 重复压缩包 (可删除)
 35M    services       # 服务代码 (需要整理)
 17M    temp           # 临时目录 (需要清理)
 12M    nats-server*   # 下载的二进制 (可整理)
4.7M    nats.zip       # 重复压缩包 (可删除)
```

---

## 🗂️ 清理分类方案

### 第一类：立即删除 🗑️
1. **备份文件**: 所有.bak/.old后缀文件
2. **临时文件**: .tmp/.cache/temp目录内容
3. **重复压缩包**: marketprism.zip, nats.zip
4. **过期日志**: 7天前的日志文件
5. **IDE临时文件**: .DS_Store, *.pyc, __pycache__

### 第二类：归档整理 📁
1. **配置文件**: 统一到config/目录
2. **Docker文件**: 整理到docker/目录
3. **脚本文件**: 整理到scripts/目录
4. **文档文件**: 整理到docs/目录
5. **测试文件**: 统一到tests/目录

### 第三类：模块分析 🔍
1. **services/**: 分析各服务使用情况
2. **config/**: 检查配置文件是否被引用
3. **scripts/**: 确认脚本是否仍在使用
4. **tests/**: 清理过期测试文件

---

## 📋 执行计划

### 阶段1: 安全评估 (30分钟)
1. **备份重要数据**: 确保不误删关键文件
2. **模块依赖分析**: 识别关键和非关键文件
3. **配置文件映射**: 了解配置文件引用关系

### 阶段2: 临时文件清理 (15分钟)
1. 删除所有.bak/.old/.tmp文件
2. 清理logs/目录中的过期日志
3. 删除重复的压缩包文件
4. 清理IDE和系统临时文件

### 阶段3: 目录结构重组 (45分钟)
1. **config/统一**: 所有配置文件集中管理
2. **docker/整理**: Docker相关文件规范化
3. **scripts/整理**: 脚本文件分类归档
4. **docs/完善**: 文档文件系统化组织

### 阶段4: 模块优化 (30分钟)
1. **未使用模块识别**: 找出废弃的代码模块
2. **重复代码清理**: 消除冗余实现
3. **依赖关系优化**: 简化模块间依赖

### 阶段5: 验证和文档 (30分钟)
1. **功能验证**: 确保清理后系统正常工作
2. **更新文档**: 更新项目结构说明
3. **创建维护指南**: 建立定期清理机制

---

## 📁 理想目录结构

```
marketprism/
├── config/                 # 所有配置文件
│   ├── environments/       # 环境配置
│   ├── exchanges/          # 交易所配置
│   ├── monitoring/         # 监控配置
│   └── docker/            # Docker配置
├── services/              # 服务代码
│   ├── python-collector/  # Python收集器
│   ├── go-collector/      # Go收集器
│   ├── reliability/       # 可靠性组件
│   └── data_normalizer/   # 数据标准化
├── scripts/               # 脚本文件
│   ├── deployment/        # 部署脚本
│   ├── maintenance/       # 维护脚本
│   └── development/       # 开发脚本
├── docs/                  # 文档
│   ├── api/              # API文档
│   ├── guides/           # 使用指南
│   ├── operations/       # 运维文档
│   └── archive/          # 归档文档
├── tests/                # 测试文件
│   ├── unit/            # 单元测试
│   ├── integration/     # 集成测试
│   └── fixtures/        # 测试数据
├── data/                 # 数据文件
│   ├── samples/         # 示例数据
│   └── exports/         # 导出数据
├── memory-bank/          # 任务记录
├── logs/                 # 日志 (定期清理)
└── temp/                 # 临时文件 (定期清理)
```

---

## ⚠️ 注意事项

### 安全措施
1. **备份策略**: 在删除前创建关键文件备份
2. **渐进清理**: 分批次执行，随时可回滚
3. **功能验证**: 每阶段后验证系统功能
4. **团队通知**: 确保团队成员了解变更

### 风险控制
1. **保留重要配置**: 不删除生产环境配置
2. **版本控制**: 使用Git跟踪所有变更
3. **回滚计划**: 准备快速恢复机制
4. **测试验证**: 清理后运行完整测试套件

---

## 📈 预期收益

### 直接收益
- **空间节省**: 预计减少50%以上项目体积
- **结构清晰**: 文件组织更加规范和易于维护
- **查找效率**: 配置和文档快速定位
- **维护简化**: 减少无用文件的维护成本

### 长期价值
- **团队效率**: 新成员更容易理解项目结构
- **部署优化**: 清晰的配置管理提升部署效率
- **技术债务**: 降低项目技术债务负担
- **扩展性**: 为后续功能开发提供良好基础

---

## 🎯 成功标准

1. **体积优化**: 项目总体积减少40%以上
2. **结构规范**: 所有文件按照新结构组织
3. **功能完整**: 所有核心功能正常工作
4. **文档更新**: 项目结构文档同步更新
5. **维护机制**: 建立定期清理的自动化机制

---

**下一步**: 开始执行第一阶段安全评估 