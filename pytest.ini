[pytest]
minversion = 6.0
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*

addopts =
    --tb=short
    --strict-config
    --cov=core
    --cov=services
    --cov-report=term-missing
    --cov-report=html:tests/reports/coverage_unit
    --cov-fail-under=4
    --asyncio-mode=auto
    -v
    -ra
    -q
    --color=yes
    --code-highlight=yes

norecursedirs =
    .vscode
    .git
    .tox
    venv
    venv_tdd
    services/python-collector/src/marketprism_collector/py-dep
    backup
    tests/unit/errors
    tests/unit/python_collector/test_types.py

asyncio_mode = auto

markers =
    unit: 单元测试
    integration: 集成测试
    performance: 性能测试
    load_testing: 负载测试
    rest_api: REST API相关测试
    websocket: WebSocket相关测试
    nats: NATS消息系统测试
    slow: 运行较慢的测试
    cross_exchange: 跨交易所测试
    data_consistency: 数据一致性测试
    real_api: 真实API集成测试
    resilience: 系统恢复能力测试
    stress: 压力测试
    memory: 内存测试
    network: 网络测试
    database: 数据库测试
    mock: Mock测试
    e2e: 端到端测试 