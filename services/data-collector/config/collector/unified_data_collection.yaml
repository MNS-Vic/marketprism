# ============================================================================
# MarketPrism ç»Ÿä¸€æ•°æ®æ”¶é›†é…ç½®æ–‡ä»¶
# ============================================================================
#
# ğŸ“‹ é…ç½®æ–‡ä»¶è¯´æ˜ï¼š
# è¿™æ˜¯MarketPrismé¡¹ç›®çš„å”¯ä¸€é…ç½®æ–‡ä»¶ï¼Œé‡‡ç”¨YAMLæ ¼å¼ç®¡ç†æ‰€æœ‰äº¤æ˜“æ‰€å’Œç³»ç»Ÿè®¾ç½®ã€‚
# åŸºäºæ–°çš„ç»Ÿä¸€WebSocketæ¶æ„ï¼Œæ”¯æŒå¤šäº¤æ˜“æ‰€ã€å¤šå¸‚åœºç±»å‹çš„æ•°æ®æ”¶é›†ã€‚
#
# ğŸ”§ ç¯å¢ƒå˜é‡è¦†ç›–æ ¼å¼ï¼š
# MARKETPRISM_{SECTION}_{KEY} = value
# ç¤ºä¾‹ï¼šMARKETPRISM_SYSTEM_ENVIRONMENT=production
#
# ğŸš¨ é‡è¦ä½¿ç”¨æé†’ï¼š
# 1. é¦–æ¬¡éƒ¨ç½²å»ºè®®é‡‡ç”¨æ¸è¿›å¼ç­–ç•¥ï¼Œé¿å…ç³»ç»Ÿè¿‡è½½
# 2. æ•°æ®ç±»å‹åç§°å¿…é¡»ä¸ç³»ç»Ÿæšä¸¾å®Œå…¨åŒ¹é… (å¦‚"trade"ä¸æ˜¯"trades")
# 3. é«˜é¢‘æ•°æ®ç±»å‹(LSR)ä¼šå¢åŠ APIè¯·æ±‚é¢‘ç‡ï¼Œæ³¨æ„äº¤æ˜“æ‰€é™åˆ¶
# 4. ä¿®æ”¹é…ç½®åéœ€è¦é‡å¯ç³»ç»Ÿæ‰èƒ½ç”Ÿæ•ˆ
# 5. å»ºè®®å…ˆåœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯é…ç½®æ­£ç¡®æ€§
#
# ğŸ“Š å»ºè®®çš„æ¸è¿›å¼éƒ¨ç½²é¡ºåºï¼š
# é˜¶æ®µ1: ["volatility_index"] - éªŒè¯åŸºç¡€åŠŸèƒ½
# é˜¶æ®µ2: ["trade", "funding_rate"] - æ·»åŠ æ ¸å¿ƒæ•°æ®
# é˜¶æ®µ3: ["trade", "funding_rate", "open_interest", "liquidation"] - æ·»åŠ ä¸­é¢‘æ•°æ®
# é˜¶æ®µ4: ["trade", "funding_rate", "open_interest", "liquidation", "lsr_top_position"] - æ·»åŠ é«˜é¢‘æ•°æ®
# é˜¶æ®µ5: å®Œæ•´é…ç½® - æ‰€æœ‰æ•°æ®ç±»å‹
#
# ğŸ“Š æ”¯æŒçš„äº¤æ˜“æ‰€ï¼š
# - Binanceç°è´§ (binance_spot): æ”¯æŒç°è´§äº¤æ˜“å¯¹æ•°æ®æ”¶é›†
# - Binanceè¡ç”Ÿå“ (binance_derivatives): æ”¯æŒæ°¸ç»­åˆçº¦æ•°æ®æ”¶é›†
# - OKXç°è´§ (okx_spot): æ”¯æŒç°è´§äº¤æ˜“å¯¹æ•°æ®æ”¶é›†
# - OKXè¡ç”Ÿå“ (okx_derivatives): æ”¯æŒæ°¸ç»­åˆçº¦æ•°æ®æ”¶é›†
#
# ğŸ“ˆ æ”¯æŒçš„æ•°æ®ç±»å‹ï¼ˆâš ï¸ åç§°å¿…é¡»å®Œå…¨åŒ¹é…ï¼‰ï¼š
#
# ğŸ”´ å®æ—¶æ•°æ®ç±»å‹ï¼ˆWebSocketæ¨é€ï¼‰ï¼š
# - "trade": å®æ—¶æˆäº¤æ•°æ®ï¼ˆä»·æ ¼ã€æ•°é‡ã€æ–¹å‘ï¼‰âŒ ä¸æ˜¯"trades"
# - "orderbook": è®¢å•ç°¿æ·±åº¦æ•°æ®ï¼ˆå®æ—¶ä¹°å–ç›˜æ·±åº¦ï¼‰
# - "liquidation": å¼ºå¹³æ•°æ®ï¼ˆå®æ—¶å¼ºåˆ¶å¹³ä»“ä¿¡æ¯ï¼‰
#
# ğŸŸ¡ å®šæ—¶æ•°æ®ç±»å‹ï¼ˆREST APIè½®è¯¢ï¼‰ï¼š
# - "funding_rate": èµ„é‡‘è´¹ç‡ï¼ˆ1åˆ†é’Ÿé—´éš”ç”¨äºæµ‹è¯•ï¼Œä»…è¡ç”Ÿå“å¸‚åœºï¼‰
# - "open_interest": æŒä»“é‡ï¼ˆ5åˆ†é’Ÿé—´éš”ï¼Œä»…è¡ç”Ÿå“å¸‚åœºï¼‰
# - "volatility_index": æ³¢åŠ¨ç‡æŒ‡æ•°ï¼ˆ1åˆ†é’Ÿé—´éš”ï¼Œä»…Deribitæ”¯æŒï¼‰
#
# ğŸŸ  é«˜é¢‘æ•°æ®ç±»å‹ï¼ˆ10ç§’é—´éš”ï¼Œæ³¨æ„APIé™åˆ¶ï¼‰ï¼š
# - "lsr_top_position": é¡¶çº§å¤§æˆ·å¤šç©ºæŒä»“æ¯”ä¾‹ï¼ˆæŒ‰æŒä»“é‡è®¡ç®—ï¼‰
# - "lsr_all_account": å…¨å¸‚åœºå¤šç©ºæŒä»“äººæ•°æ¯”ä¾‹ï¼ˆæŒ‰è´¦æˆ·æ•°è®¡ç®—ï¼‰
#
# âš ï¸ å¸¸è§é…ç½®é”™è¯¯ï¼š
# âŒ "trades" â†’ âœ… "trade"
# âŒ "positions" â†’ âœ… "lsr_top_position"
# âŒ "accounts" â†’ âœ… "lsr_all_account"
#
# ğŸ¯ é…ç½®ç»“æ„ï¼š
# - system: ç³»ç»ŸåŸºç¡€é…ç½®ï¼ˆåç§°ã€ç‰ˆæœ¬ã€ç¯å¢ƒç­‰ï¼‰
# - exchanges: äº¤æ˜“æ‰€é…ç½®ï¼ˆè¿æ¥å‚æ•°ã€æ•°æ®ç±»å‹ã€ç¬¦å·ç­‰ï¼‰
# - nats: NATSæ¶ˆæ¯é˜Ÿåˆ—é…ç½®ï¼ˆæœåŠ¡å™¨ã€ä¸»é¢˜ã€å®¢æˆ·ç«¯è®¾ç½®ï¼‰
# - monitoring: ç³»ç»Ÿç›‘æ§é…ç½®ï¼ˆå†…å­˜ã€CPUã€è¿æ¥ç›‘æ§ï¼‰
#
# ğŸ“ ç‰ˆæœ¬ä¿¡æ¯ï¼š
# ç‰ˆæœ¬: 2.0.0
# åˆ›å»ºæ—¶é—´: 2025-07-25
# æœ€åæ›´æ–°: 2025-07-25
# ç»´æŠ¤è€…: MarketPrism Team

# ============================================================================
# ç³»ç»Ÿé…ç½® - åŸºç¡€ç³»ç»Ÿè®¾ç½®
# ============================================================================
#
# ğŸ”§ ç³»ç»Ÿé…ç½®è¯´æ˜ï¼š
# - name: ç³»ç»Ÿåç§°ï¼Œç”¨äºæ ‡è¯†å’Œæ—¥å¿—è®°å½•
# - version: ç³»ç»Ÿç‰ˆæœ¬å·ï¼Œéµå¾ªè¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶
# - environment: è¿è¡Œç¯å¢ƒï¼ˆproduction/development/testingï¼‰
# - debug: è°ƒè¯•æ¨¡å¼å¼€å…³ï¼Œå½±å“æ—¥å¿—è¯¦ç»†ç¨‹åº¦
# - use_unified_websocket: å¯ç”¨ç»Ÿä¸€WebSocketæ¶æ„ï¼ˆæ¨ètrueï¼‰
#
# ğŸ“Š æ—¥å¿—é…ç½®è¯´æ˜ï¼š
# - level: æ—¥å¿—çº§åˆ«ï¼ˆDEBUG/INFO/WARNING/ERRORï¼‰
# - format: æ—¥å¿—æ ¼å¼ï¼ˆjson/textï¼‰ï¼Œç”Ÿäº§ç¯å¢ƒæ¨èjson
# - file: æ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼Œæ”¯æŒç»å¯¹è·¯å¾„å’Œç›¸å¯¹è·¯å¾„
# - max_size: å•ä¸ªæ—¥å¿—æ–‡ä»¶æœ€å¤§å¤§å°ï¼Œæ”¯æŒKB/MB/GBå•ä½
# - backup_count: æ—¥å¿—è½®è½¬ä¿ç•™æ–‡ä»¶æ•°é‡

system:
  name: "marketprism-unified-collector"  # ç³»ç»Ÿæ ‡è¯†åç§°
  version: "2.0.0"                       # å½“å‰ç‰ˆæœ¬å·
  environment: "production"              # è¿è¡Œç¯å¢ƒï¼šproduction/development/testing
  debug: false                           # è°ƒè¯•æ¨¡å¼ï¼šfalse=ç”Ÿäº§æ¨¡å¼ï¼Œtrue=è°ƒè¯•æ¨¡å¼

  # å¯ç”¨æ–°çš„ç»Ÿä¸€WebSocketæ¶æ„ï¼ˆæ¨èä¿æŒtrueï¼‰
  use_unified_websocket: true

  # æ—¥å¿—é…ç½®
  logging:
    level: "INFO"                        # æ—¥å¿—çº§åˆ«ï¼šDEBUG/INFO/WARNING/ERROR
    format: "json"                       # æ—¥å¿—æ ¼å¼ï¼šjson/text
    file: "./logs/unified-collector.log"   # æ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼ˆç›¸å¯¹äºæœåŠ¡ç›®å½•ï¼‰
    max_size: "100MB"                    # å•æ–‡ä»¶æœ€å¤§å¤§å°
    backup_count: 5                      # è½®è½¬ä¿ç•™æ–‡ä»¶æ•°

# ç½‘ç»œé…ç½®
networking:
  # WebSocketè¿æ¥é…ç½®
  websocket:
    timeout: 60  # å¢åŠ åˆ°60ç§’ï¼Œç»™Binanceæ›´å¤šè¿æ¥æ—¶é—´
    max_retries: 3
    retry_delay: 5
    ping_interval: 20
    ping_timeout: 60
    max_size: 1048576  # 1MB

    # é•¿æœŸè¿è¡Œé…ç½®
    auto_reconnect: true
    max_reconnect_attempts: -1  # æ— é™é‡è¿
    reconnect_delay: 1.0
    max_reconnect_delay: 300.0
    backoff_multiplier: 2.0
    connection_timeout: 86400  # 24å°æ—¶

    # ä¸»åŠ¨é‡è¿é…ç½®
    proactive_reconnect_enabled: true
    proactive_reconnect_threshold: 86100  # 23å°æ—¶55åˆ†é’Ÿ
    dual_connection_enabled: true
    data_buffer_size: 1000

    # WebSocketç¨³å®šæ€§ä¼˜åŒ–é…ç½®
    stability:
      # å¿ƒè·³æœºåˆ¶é…ç½®
      heartbeat:
        binance_spot_interval: 20      # Binanceç°è´§å¿ƒè·³é—´éš”ï¼ˆç§’ï¼‰
        binance_derivatives_interval: 180  # Binanceè¡ç”Ÿå“å¿ƒè·³é—´éš”ï¼ˆç§’ï¼‰
        okx_interval: 25               # OKXå¿ƒè·³é—´éš”ï¼ˆç§’ï¼‰
        timeout: 60                    # å¿ƒè·³è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
        max_consecutive_failures: 3   # æœ€å¤§è¿ç»­å¤±è´¥æ¬¡æ•°

      # é‡è¿æœºåˆ¶é…ç½®
      reconnection:
        enabled: true
        initial_delay: 1.0             # åˆå§‹é‡è¿å»¶è¿Ÿï¼ˆç§’ï¼‰
        max_delay: 30.0               # æœ€å¤§é‡è¿å»¶è¿Ÿï¼ˆç§’ï¼‰
        backoff_multiplier: 2.0       # æŒ‡æ•°é€€é¿å€æ•°
        max_attempts: -1              # æœ€å¤§é‡è¿æ¬¡æ•°ï¼ˆ-1ä¸ºæ— é™ï¼‰
        connection_timeout: 30.0      # è¿æ¥è¶…æ—¶ï¼ˆç§’ï¼‰- å¢åŠ åˆ°30ç§’
        health_check_interval: 30.0   # å¥åº·æ£€æŸ¥é—´éš”ï¼ˆç§’ï¼‰

      # å†…å­˜ç®¡ç†é…ç½®
      memory_management:
        enabled: true
        max_orderbook_states: 1000    # æœ€å¤§è®¢å•ç°¿çŠ¶æ€æ•°é‡
        cleanup_interval: 300.0       # æ¸…ç†é—´éš”ï¼ˆç§’ï¼‰
        inactive_threshold: 3600.0    # éæ´»è·ƒé˜ˆå€¼ï¼ˆç§’ï¼‰
        memory_check_interval: 60.0   # å†…å­˜æ£€æŸ¥é—´éš”ï¼ˆç§’ï¼‰
        max_memory_mb: 512            # æœ€å¤§å†…å­˜ä½¿ç”¨ï¼ˆMBï¼‰
        memory_warning_threshold: 0.8 # å†…å­˜è­¦å‘Šé˜ˆå€¼ï¼ˆ80%ï¼‰

      # é”™è¯¯æ¢å¤é…ç½®
      error_recovery:
        enabled: true
        max_consecutive_errors: 5     # æœ€å¤§è¿ç»­é”™è¯¯æ¬¡æ•°
        error_reset_interval: 300.0   # é”™è¯¯é‡ç½®é—´éš”ï¼ˆç§’ï¼‰
        checksum_failure_threshold: 3 # checksumå¤±è´¥é˜ˆå€¼
        sequence_error_threshold: 3   # åºåˆ—é”™è¯¯é˜ˆå€¼
        auto_resync_enabled: true     # è‡ªåŠ¨é‡æ–°åŒæ­¥
        resync_delay: 5.0             # é‡æ–°åŒæ­¥å»¶è¿Ÿï¼ˆç§’ï¼‰
        max_resync_attempts: 3        # æœ€å¤§é‡æ–°åŒæ­¥å°è¯•æ¬¡æ•°

      # æ€§èƒ½ç›‘æ§é…ç½®ï¼ˆåŸºäºAPIæµ‹è¯•ä¼˜åŒ–ï¼‰
      performance_monitoring:
        enabled: true
        monitoring_interval: 60.0     # ç›‘æ§é—´éš”ï¼ˆç§’ï¼‰
        latency_warning_threshold: 200.0  # å»¶è¿Ÿè­¦å‘Šé˜ˆå€¼ï¼ˆæ¯«ç§’ï¼ŒåŸºäºAPIæµ‹è¯•ä¼˜åŒ–ï¼‰
        throughput_warning_threshold: 0.1 # ååé‡è­¦å‘Šé˜ˆå€¼ï¼ˆmsg/sï¼‰- è®¾ç½®ä¸ºæä½å€¼ä»¥ç¦ç”¨è­¦å‘Š
        cpu_warning_threshold: 80.0   # CPUè­¦å‘Šé˜ˆå€¼ï¼ˆ%ï¼‰
        detailed_stats_interval: 300.0 # è¯¦ç»†ç»Ÿè®¡é—´éš”ï¼ˆç§’ï¼‰
        performance_history_size: 100 # æ€§èƒ½å†å²è®°å½•å¤§å°

      # æ—¥å¿—è®°å½•é…ç½®
      logging:
        enabled: true
        log_level: "INFO"             # DEBUG, INFO, WARNING, ERROR
        structured_logging: true      # ç»“æ„åŒ–æ—¥å¿—
        log_performance: true         # è®°å½•æ€§èƒ½æ—¥å¿—
        log_errors: true              # è®°å½•é”™è¯¯æ—¥å¿—
        log_connections: true         # è®°å½•è¿æ¥æ—¥å¿—
        log_data_flow: false          # è®°å½•æ•°æ®æµæ—¥å¿—ï¼ˆè°ƒè¯•ç”¨ï¼‰
        sensitive_fields: ["api_key", "api_secret", "passphrase"]  # æ•æ„Ÿå­—æ®µ
  
  # HTTPé…ç½®
  http:
    timeout: 60  # å¢åŠ åˆ°60ç§’ï¼Œç»™REST APIæ›´å¤šæ—¶é—´
    connector_limit: 100
    connector_limit_per_host: 30
    retry_attempts: 3
  
  # ä»£ç†é…ç½®
  proxy:
    enabled: false
    # http_proxy: "http://proxy.example.com:8080"
    # https_proxy: "http://proxy.example.com:8080"

# ============================================================================
# äº¤æ˜“æ‰€é…ç½® - å¤šäº¤æ˜“æ‰€æ•°æ®æ”¶é›†è®¾ç½®
# ============================================================================
#
# ğŸ¢ äº¤æ˜“æ‰€é…ç½®è¯´æ˜ï¼š
# æ¯ä¸ªäº¤æ˜“æ‰€é…ç½®åŒ…å«ä»¥ä¸‹æ ¸å¿ƒå‚æ•°ï¼š
# - enabled: æ˜¯å¦å¯ç”¨è¯¥äº¤æ˜“æ‰€çš„æ•°æ®æ”¶é›†
# - symbols: è¦æ”¶é›†çš„äº¤æ˜“å¯¹åˆ—è¡¨ï¼ˆæ”¯æŒå¤šä¸ªç¬¦å·ï¼‰
# - data_types: è¦æ”¶é›†çš„æ•°æ®ç±»å‹ï¼ˆorderbook/trade/funding_rate/open_interestï¼‰
# - websocket: WebSocketè¿æ¥é…ç½®ï¼ˆURLã€å¿ƒè·³ã€é‡è¿ç­‰ï¼‰
# - api: REST APIé…ç½®ï¼ˆç”¨äºåˆå§‹åŒ–å’Œè¡¥å……æ•°æ®ï¼‰
# - rate_limits: APIè°ƒç”¨é¢‘ç‡é™åˆ¶é…ç½®
#
# ğŸ“Š æ•°æ®ç±»å‹è¯´æ˜ï¼š
# - orderbook: è®¢å•ç°¿æ·±åº¦æ•°æ®ï¼ŒåŒ…å«ä¹°å–ç›˜ä»·æ ¼å’Œæ•°é‡
# - trade: å®æ—¶æˆäº¤æ•°æ®ï¼ŒåŒ…å«ä»·æ ¼ã€æ•°é‡ã€ä¹°å–æ–¹å‘
# - funding_rate: èµ„é‡‘è´¹ç‡ï¼ˆä»…è¡ç”Ÿå“ï¼‰ï¼Œå½±å“æŒä»“æˆæœ¬
# - open_interest: æŒä»“é‡ï¼ˆä»…è¡ç”Ÿå“ï¼‰ï¼Œåæ˜ å¸‚åœºæ´»è·ƒåº¦
#
# ğŸ”— WebSocketé…ç½®è¯´æ˜ï¼š
# - url: WebSocketæœåŠ¡å™¨åœ°å€
# - heartbeat_interval: å¿ƒè·³é—´éš”ï¼ˆç§’ï¼‰ï¼Œä¿æŒè¿æ¥æ´»è·ƒ
# - reconnect_interval: é‡è¿é—´éš”ï¼ˆç§’ï¼‰ï¼Œè¿æ¥æ–­å¼€åçš„é‡è¿å»¶è¿Ÿ
# - max_reconnect_attempts: æœ€å¤§é‡è¿æ¬¡æ•°ï¼Œ0è¡¨ç¤ºæ— é™é‡è¿
# - connection_timeout: è¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
#
# ğŸŒ APIé…ç½®è¯´æ˜ï¼š
# - base_url: REST APIåŸºç¡€URL
# - timeout: è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
# - max_retries: æœ€å¤§é‡è¯•æ¬¡æ•°
# - retry_delay: é‡è¯•å»¶è¿Ÿï¼ˆç§’ï¼‰

exchanges:
  # Binanceç°è´§ - å¯ç”¨å®Œæ•´æµ‹è¯•
  binance_spot:
    name: "binance"
    exchange: "binance_spot"
    market_type: "spot"
    enabled: true  # å¯ç”¨å®Œæ•´æµ‹è¯•

    # APIç«¯ç‚¹
    api:
      base_url: "https://api.binance.com"
      ws_url: "wss://stream.binance.com:9443"

    # äº¤æ˜“å¯¹é…ç½® - æµ‹è¯•BTCå’ŒETH
    symbols: ["BTCUSDT", "ETHUSDT"]  # å¯ç”¨BTCå’ŒETHè¿›è¡Œå…¨é¢æµ‹è¯•

    # æ•°æ®ç±»å‹ - å¯ç”¨orderbookå’Œtradeç®¡ç†å™¨
    data_types: ["orderbook", "trade"]  # å¯ç”¨orderbookå’Œtradeç®¡ç†å™¨

    # è®¢å•ç°¿é…ç½® - 500æ¡£æ”¶é›†ï¼Œ400æ¡£å‘é€ï¼Œæ¯ç§’å¿«ç…§
    orderbook:
      depth_limit: 500  # ä»500æ¡£æ”¶é›†æ•°æ®
      nats_publish_depth: 400  # å‘é€400æ¡£åˆ°NATS
      snapshot_interval: 1  # æ¯ç§’è·å–ä¸€æ¬¡å¿«ç…§
      update_frequency: 100
      validation_enabled: true
  
  # Binanceè¡ç”Ÿå“ï¼ˆæ°¸ç»­åˆçº¦ï¼‰- å¯ç”¨OrderBookç®¡ç†å™¨
  binance_derivatives:
    name: "binance_derivatives"
    exchange: "binance_derivatives"
    market_type: "perpetual"
    enabled: true  # å¯ç”¨Binanceè¡ç”Ÿå“OrderBookç®¡ç†å™¨
    
    # APIç«¯ç‚¹ï¼ˆæ°¸ç»­åˆçº¦ï¼‰
    api:
      base_url: "https://fapi.binance.com"
      ws_url: "wss://fstream.binance.com"
    
    # æ°¸ç»­åˆçº¦äº¤æ˜“å¯¹ - æµ‹è¯•BTCå’ŒETH
    symbols: ["BTCUSDT", "ETHUSDT"]  # å¯ç”¨BTCå’ŒETHè¿›è¡Œå…¨é¢æµ‹è¯•

    # æ•°æ®ç±»å‹é…ç½® - å¯ç”¨è¡ç”Ÿå“æ”¯æŒçš„æ‰€æœ‰æ•°æ®ç±»å‹
    data_types: ["orderbook", "trade", "funding_rate", "open_interest", "liquidation", "lsr_top_position", "lsr_all_account"]  # å¯ç”¨æ‰€æœ‰è¡ç”Ÿå“æ•°æ®ç±»å‹
    
    # è®¢å•ç°¿é…ç½® - 500æ¡£æ”¶é›†ï¼Œ400æ¡£å‘é€ï¼Œæ¯ç§’å¿«ç…§
    orderbook:
      depth_limit: 500  # ä»500æ¡£æ”¶é›†æ•°æ®
      nats_publish_depth: 400  # å‘é€400æ¡£åˆ°NATS
      snapshot_interval: 1  # æ¯ç§’è·å–ä¸€æ¬¡å¿«ç…§
      update_frequency: 100
      validation_enabled: true
  
  # OKXç°è´§ - å¯ç”¨å®Œæ•´æµ‹è¯•
  okx_spot:
    name: "okx_spot"
    exchange: "okx_spot"
    market_type: "spot"
    enabled: true  # å¯ç”¨å®Œæ•´æµ‹è¯•
    
    # APIç«¯ç‚¹
    api:
      base_url: "https://www.okx.com"
      ws_url: "wss://ws.okx.com:8443/ws/v5/public"
    
    # ç°è´§äº¤æ˜“å¯¹ - æµ‹è¯•BTCå’ŒETH
    symbols: ["BTC-USDT", "ETH-USDT"]  # å¯ç”¨BTCå’ŒETHè¿›è¡Œå…¨é¢æµ‹è¯•

    # æ•°æ®ç±»å‹ - å¯ç”¨orderbookå’Œtradeç®¡ç†å™¨
    data_types: ["orderbook", "trade"]  # å¯ç”¨orderbookå’Œtradeç®¡ç†å™¨

    # è®¢å•ç°¿é…ç½® - 500æ¡£æ”¶é›†ï¼Œ400æ¡£å‘é€ï¼Œæ¯ç§’å¿«ç…§
    orderbook:
      depth_limit: 500  # ä»500æ¡£æ”¶é›†æ•°æ®
      nats_publish_depth: 400  # å‘é€400æ¡£åˆ°NATS
      snapshot_interval: 1  # æ¯ç§’è·å–ä¸€æ¬¡å¿«ç…§
      update_frequency: 100
      validation_enabled: true
  
  # OKXè¡ç”Ÿå“ï¼ˆæ°¸ç»­åˆçº¦ï¼‰- å¯ç”¨OrderBookç®¡ç†å™¨
  okx_derivatives:
    name: "okx_derivatives"
    exchange: "okx_derivatives"
    market_type: "perpetual"
    enabled: true  # å¯ç”¨OKXè¡ç”Ÿå“OrderBookç®¡ç†å™¨
    
    # APIç«¯ç‚¹
    api:
      base_url: "https://www.okx.com"
      ws_url: "wss://ws.okx.com:8443/ws/v5/public"
    
    # æ°¸ç»­åˆçº¦äº¤æ˜“å¯¹ - æµ‹è¯•BTCå’ŒETH
    symbols: ["BTC-USDT-SWAP", "ETH-USDT-SWAP"]  # å¯ç”¨BTCå’ŒETHè¿›è¡Œå…¨é¢æµ‹è¯•

    # æ•°æ®ç±»å‹é…ç½® - å¯ç”¨è¡ç”Ÿå“æ”¯æŒçš„æ‰€æœ‰æ•°æ®ç±»å‹
    data_types: ["orderbook", "trade", "funding_rate", "open_interest", "liquidation", "lsr_top_position", "lsr_all_account"]  # å¯ç”¨æ‰€æœ‰è¡ç”Ÿå“æ•°æ®ç±»å‹

    # è®¢å•ç°¿é…ç½® - 400æ¡£æ”¶é›†å’Œå‘é€ï¼Œæ¯ç§’å¿«ç…§
    orderbook:
      depth_limit: 400  # OKXé™åˆ¶ä¸º400æ¡£
      nats_publish_depth: 400  # å‘é€400æ¡£åˆ°NATS
      snapshot_interval: 1  # æ¯ç§’è·å–ä¸€æ¬¡å¿«ç…§
      update_frequency: 100
      validation_enabled: true

  # Deribitè¡ç”Ÿå“ï¼ˆæœŸæƒå’Œæ°¸ç»­åˆçº¦ï¼‰- æ³¢åŠ¨ç‡æŒ‡æ•°æ•°æ®
  deribit_derivatives:
    name: "deribit_derivatives"
    exchange: "deribit_derivatives"
    market_type: "perpetual"
    enabled: true  # å¯ç”¨ï¼Œæµ‹è¯•vol_index

    # APIç«¯ç‚¹
    api:
      base_url: "https://www.deribit.com"
      ws_url: "wss://www.deribit.com/ws/api/v2"

    # æ”¯æŒçš„è´§å¸ï¼ˆæ³¢åŠ¨ç‡æŒ‡æ•°ï¼‰
    symbols: ["BTC", "ETH"]  # Deribitæ³¢åŠ¨ç‡æŒ‡æ•°ä½¿ç”¨è´§å¸ç¬¦å·

    # æ•°æ®ç±»å‹ - ä¸“æ³¨æ³¢åŠ¨ç‡æŒ‡æ•°
    data_types: ["volatility_index"]  # æ³¢åŠ¨ç‡æŒ‡æ•°æ•°æ®

    # æ³¢åŠ¨ç‡æŒ‡æ•°é…ç½®
    vol_index:
      collection_interval_minutes: 1  # 1åˆ†é’Ÿæ”¶é›†é—´éš”
      resolution: "60"  # 1åˆ†é’Ÿåˆ†è¾¨ç‡
      timeout: 30  # è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
      max_retries: 3  # æœ€å¤§é‡è¯•æ¬¡æ•°
      retry_delay: 1.0  # é‡è¯•å»¶è¿Ÿï¼ˆç§’ï¼‰

# NATSé…ç½® - ç®€åŒ–æ¶æ„éœ€è¦å¯ç”¨
nats:
  # å¯ç”¨çŠ¶æ€
  enabled: true  # ç®€åŒ–æ¶æ„éœ€è¦NATSæ¨é€
  # è¿æ¥é…ç½®
  servers: ["nats://localhost:4222"]
  client_name: "unified-collector"
  max_reconnect_attempts: 10
  reconnect_time_wait: 2
  
  # æ•°æ®æµé…ç½®
  streams:
    # è®¢å•ç°¿æ•°æ®æµ
    orderbook: "orderbook-data.{exchange}.{market_type}.{symbol}"

    # äº¤æ˜“æ•°æ®æµ
    trade: "trade-data.{exchange}.{market_type}.{symbol}"

    # æ°¸ç»­åˆçº¦ç‰¹æœ‰æ•°æ®æµ
    funding_rate: "funding-rate.{exchange}.{market_type}.{symbol}"
    open_interest: "open-interest-data.{exchange}.{market_type}.{symbol}"

    # ğŸ”§ æ–°å¢ï¼šå¼ºå¹³è®¢å•æ•°æ®æµï¼ˆæ•´åˆè‡ªliquidation_collector.yamlï¼‰
    liquidation: "liquidation-data.{exchange}.{market_type}.{symbol}"

    # æ³¢åŠ¨ç‡æŒ‡æ•°æ•°æ®æµ
    vol_index: "volatility_index-data.{exchange}.{market_type}.{symbol}"
  
  # å‘å¸ƒé…ç½®
  publish:
    timeout: 5
    max_retries: 3
    batch_size: 100

  # ğŸ”§ JetStreamé…ç½® - ç¡®ä¿é‡‘èæ•°æ®ä¸ä¸¢å¤±
  jetstream:
    enabled: true  # å¯ç”¨JetStreamç¡®ä¿æ•°æ®æŒä¹…åŒ–
    streams:
      MARKET_DATA:
        name: "MARKET_DATA"
        subjects:
          - "orderbook-data.>"
          - "trade-data.>"
          - "funding-rate.>"
          - "open-interest.>"
          - "liquidation-data.>"  # ğŸ”§ æ›´æ–°ï¼šç»Ÿä¸€å¼ºå¹³æ•°æ®ä¸»é¢˜æ ¼å¼
          - "kline-data.>"
          - "volatility_index-data.>"  # æ³¢åŠ¨ç‡æŒ‡æ•°æ•°æ®
        retention: "limits"
        max_msgs: 5000000      # 500ä¸‡æ¡æ¶ˆæ¯
        max_bytes: 2147483648  # 2GB
        max_age: 172800        # 48å°æ—¶
        max_consumers: 50      # æ”¯æŒ50ä¸ªæ¶ˆè´¹è€…
        replicas: 1
        storage: "file"        # æ–‡ä»¶å­˜å‚¨ç¡®ä¿æŒä¹…åŒ–
        discard: "old"         # è¾¾åˆ°é™åˆ¶æ—¶ä¸¢å¼ƒæ—§æ¶ˆæ¯
        duplicate_window: 120  # 2åˆ†é’Ÿé‡å¤æ£€æµ‹

# ClickHouseé…ç½®
clickhouse:
  # è¿æ¥é…ç½®
  host: "localhost"
  port: 9000
  database: "marketprism"
  username: "default"
  password: ""
  
  # è¡¨é…ç½®
  tables:
    orderbook_spot: "orderbook_spot"
    orderbook_perpetual: "orderbook_perpetual"
    trades_spot: "trades_spot"
    trades_perpetual: "trades_perpetual"
    funding_rates: "funding_rates"
    open_interest: "open_interest"
  
  # æ‰¹é‡å†™å…¥é…ç½®
  batch:
    size: 1000
    timeout: 10
    max_retries: 3

# ç›‘æ§é…ç½®
monitoring:
  # æŒ‡æ ‡æ”¶é›†
  metrics:
    enabled: true
    port: 9093
    path: "/metrics"
  
  # å¥åº·æ£€æŸ¥
  health_check:
    enabled: true
    port: 8086  # å¥åº·æ£€æŸ¥ç«¯å£
    path: "/health"
    interval: 30
  
  # æ€§èƒ½ç›‘æ§
  performance:
    enabled: true
    sample_rate: 0.1
    track_memory: true
    track_cpu: true

# é”™è¯¯å¤„ç†é…ç½®
error_handling:
  # é‡è¯•é…ç½®
  retry:
    max_attempts: 3
    backoff_multiplier: 2.0
    max_backoff_seconds: 300
  
  # ç†”æ–­å™¨é…ç½®
  circuit_breaker:
    enabled: true
    failure_threshold: 5
    recovery_timeout: 60
  
  # å‘Šè­¦é…ç½®
  alerts:
    enabled: true
    webhook_url: ""
    critical_errors: ["connection_failed", "data_corruption", "nats_publish_failed"]

# æ•°æ®è´¨é‡é…ç½®
data_quality:
  # éªŒè¯è§„åˆ™
  validation:
    enabled: true
    strict_mode: false
    max_price_deviation: 0.1  # 10%
    max_timestamp_drift: 5    # 5ç§’

  # æ•°æ®æ¸…æ´—
  cleaning:
    enabled: true
    remove_duplicates: true
    filter_invalid_prices: true
    normalize_timestamps: true

  # ğŸ”§ ä»data_collection_config.ymlè¿ç§»çš„å¢å¼ºé…ç½®
  deduplication_enabled: true
  anomaly_detection_enabled: true
  price_deviation_threshold: 0.1  # 10%
  volume_threshold: 1000
  completeness_target: 0.95  # 95%
  latency_target: 1000  # 1ç§’ï¼ˆæ¯«ç§’ï¼‰

# ğŸ”§ æ–°å¢ï¼šæ•°æ®ç±»å‹è¯¦ç»†é…ç½®ï¼ˆä»data_collection_config.ymlè¿ç§»ï¼‰
data_types:
  # è®¢å•ç°¿æ•°æ® - å¯ç”¨æ‰€æœ‰å››ä¸ªäº¤æ˜“æ‰€
  orderbook:
    enabled: true
    method: "websocket"
    interval: null
    real_time: true
    historical: false
    exchanges: ["binance_spot", "binance_derivatives", "okx_spot", "okx_derivatives"]  # å¯ç”¨æ‰€æœ‰å››ä¸ªäº¤æ˜“æ‰€

  # äº¤æ˜“æ•°æ® - å¯ç”¨æ‰€æœ‰å››ä¸ªäº¤æ˜“æ‰€
  trade:
    enabled: true
    method: "websocket"
    interval: null
    real_time: true
    historical: false
    exchanges: ["binance_spot", "binance_derivatives", "okx_spot", "okx_derivatives"]  # å¯ç”¨æ‰€æœ‰å››ä¸ªäº¤æ˜“æ‰€



  # èµ„é‡‘è´¹ç‡ï¼ˆä»…è¡ç”Ÿå“ï¼‰- å¯ç”¨ï¼Œä¿®æ”¹ä¸º1åˆ†é’Ÿé—´éš”ç”¨äºæµ‹è¯•
  funding_rate:
    enabled: true
    method: "rest_api"
    interval: 60  # 1åˆ†é’Ÿ = 60ç§’ï¼Œç”¨äºæµ‹è¯•å’Œå®æ—¶ç›‘æ§
    real_time: false
    historical: false
    exchanges:
      binance_derivatives:
        enabled: true
        symbols: ["BTC-USDT", "ETH-USDT"]
        api_endpoint: "/fapi/v1/premiumIndex"
        base_url: "https://fapi.binance.com"
      okx_derivatives:
        enabled: true
        symbols: ["BTC-USDT", "ETH-USDT"]
        api_endpoint: "/api/v5/public/funding-rate"
        base_url: "https://www.okx.com"

  # æŒä»“é‡ï¼ˆä»…è¡ç”Ÿå“ï¼‰- å¯ç”¨
  open_interest:
    enabled: true
    method: "rest_api"
    interval: 300  # æ¯5åˆ†é’Ÿ = 300ç§’
    real_time: false
    historical: false
    exchanges:
      binance_derivatives:
        enabled: true
        symbols: ["BTC-USDT", "ETH-USDT"]
        api_endpoint: "/fapi/v1/openInterestHist"
        base_url: "https://fapi.binance.com"
        period: "5m"
        limit: 1
      okx_derivatives:
        enabled: true
        symbols: ["BTC-USDT", "ETH-USDT"]
        api_endpoint: "/api/v5/rubik/stat/contracts/open-interest-volume"
        base_url: "https://www.okx.com"
        period: "5m"
        limit: "1"

  # ğŸ”§ æ–°å¢ï¼šå¼ºå¹³è®¢å•æ•°æ®ï¼ˆæ•´åˆè‡ªliquidation_collector.yamlï¼‰- å¯ç”¨è¡ç”Ÿå“å¼ºå¹³æ•°æ®æ”¶é›†
  liquidation:
    enabled: true
    method: "websocket"
    interval: null
    real_time: true
    historical: false
    exchanges: ["okx_derivatives", "binance_derivatives"]  # å¯ç”¨OKXå’ŒBinanceè¡ç”Ÿå“å¼ºå¹³æ•°æ®

    # å¼ºå¹³æ•°æ®è¿‡æ»¤é…ç½® - æµ‹è¯•æœŸé—´æš‚æ—¶ç¦ç”¨è¿‡æ»¤å™¨
    filters:
      min_value_usd: 0  # æµ‹è¯•æœŸé—´è®¾ä¸º0ï¼Œæ¥æ”¶æ‰€æœ‰å¼ºå¹³æ•°æ®
      max_value_usd: 10000000  # æœ€å¤§å¼ºå¹³ä»·å€¼ (ç¾å…ƒ)

    # æ•°æ®éªŒè¯
    validation:
      required_fields: ["exchange_name", "symbol_name", "side", "price", "quantity"]
      price_range_check: true
      quantity_range_check: true

    # å‘Šè­¦é…ç½®
    alerts:
      large_liquidation_threshold: 100000  # å¤§é¢å¼ºå¹³é˜ˆå€¼ï¼ˆç¾å…ƒï¼‰

  # ğŸ”§ æ–°å¢ï¼šé¡¶çº§å¤§æˆ·å¤šç©ºæŒä»“æ¯”ä¾‹æ•°æ®ï¼ˆæŒ‰æŒä»“é‡è®¡ç®—ï¼‰ - å¯ç”¨è¡ç”Ÿå“é¡¶çº§å¤§æˆ·å¤šç©ºæŒä»“æ¯”ä¾‹æ•°æ®æ”¶é›†
  lsr_top_position:
    enabled: true
    method: "rest_api"
    interval: 10  # è·å–é—´éš”ï¼ˆç§’ï¼‰
    real_time: false
    historical: true
    exchanges: ["okx_derivatives", "binance_derivatives"]  # å¯ç”¨OKXå’ŒBinanceè¡ç”Ÿå“

    # APIè°ƒç”¨é…ç½®
    api_config:
      period: "5m"        # æ•°æ®å‘¨æœŸ (5m, 15m, 30m, 1h, 2h, 4h, 6h, 12h, 1d)
      limit: 30           # è·å–æ•°æ®ç‚¹æ•°é‡
      max_retries: 3      # æœ€å¤§é‡è¯•æ¬¡æ•°
      retry_delay: 5      # é‡è¯•å»¶è¿Ÿï¼ˆç§’ï¼‰
      timeout: 30         # è¯·æ±‚è¶…æ—¶ï¼ˆç§’ï¼‰

    # æ•°æ®éªŒè¯
    validation:
      required_fields: ["exchange_name", "symbol_name", "long_short_ratio", "timestamp"]
      ratio_range_check: true
      min_ratio: 0.1      # æœ€å°å¤šç©ºæ¯”ä¾‹
      max_ratio: 10.0     # æœ€å¤§å¤šç©ºæ¯”ä¾‹

    # å‘Šè­¦é…ç½®
    alerts:
      extreme_ratio_threshold: 5.0  # æç«¯å¤šç©ºæ¯”ä¾‹é˜ˆå€¼

  # ğŸ”§ æ–°å¢ï¼šå…¨å¸‚åœºå¤šç©ºæŒä»“äººæ•°æ¯”ä¾‹æ•°æ®ï¼ˆæŒ‰è´¦æˆ·æ•°è®¡ç®—ï¼‰ - å¯ç”¨è¡ç”Ÿå“å…¨å¸‚åœºå¤šç©ºæŒä»“äººæ•°æ¯”ä¾‹æ•°æ®æ”¶é›†
  lsr_all_account:
    enabled: true
    method: "rest_api"
    interval: 10  # è·å–é—´éš”ï¼ˆç§’ï¼‰
    real_time: false
    historical: true
    exchanges: ["okx_derivatives", "binance_derivatives"]  # å¯ç”¨OKXå’ŒBinanceè¡ç”Ÿå“

    # APIè°ƒç”¨é…ç½®
    api_config:
      period: "5m"        # æ•°æ®å‘¨æœŸ (5m, 15m, 30m, 1h, 2h, 4h, 6h, 12h, 1d)
      limit: 30           # è·å–æ•°æ®ç‚¹æ•°é‡
      max_retries: 3      # æœ€å¤§é‡è¯•æ¬¡æ•°
      retry_delay: 5      # é‡è¯•å»¶è¿Ÿï¼ˆç§’ï¼‰
      timeout: 30         # è¯·æ±‚è¶…æ—¶ï¼ˆç§’ï¼‰

    # æ•°æ®éªŒè¯
    validation:
      required_fields: ["exchange_name", "symbol_name", "long_short_ratio", "timestamp"]
      ratio_range_check: true
      min_ratio: 0.1      # æœ€å°å¤šç©ºæ¯”ä¾‹
      max_ratio: 10.0     # æœ€å¤§å¤šç©ºæ¯”ä¾‹

    # å‘Šè­¦é…ç½®
    alerts:
      extreme_ratio_threshold: 5.0  # æç«¯å¤šç©ºæ¯”ä¾‹é˜ˆå€¼

  # ğŸ”§ æ–°å¢ï¼šæ³¢åŠ¨ç‡æŒ‡æ•°æ•°æ®ï¼ˆDeribitä¸“ç”¨ï¼‰ - å¯ç”¨æ³¢åŠ¨ç‡æŒ‡æ•°æ•°æ®æ”¶é›†
  volatility_index:
    enabled: true
    method: "rest_api"
    interval: 60  # è·å–é—´éš”ï¼ˆç§’ï¼‰- 1åˆ†é’Ÿé—´éš”
    real_time: false
    historical: false
    exchanges: ["deribit_derivatives"]  # å¯ç”¨Deribitè¡ç”Ÿå“

    # APIè°ƒç”¨é…ç½®
    api_config:
      collection_interval_minutes: 1  # 1åˆ†é’Ÿæ”¶é›†é—´éš”
      resolution: "60"  # 1åˆ†é’Ÿåˆ†è¾¨ç‡
      timeout: 30  # è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
      max_retries: 3  # æœ€å¤§é‡è¯•æ¬¡æ•°
      retry_delay: 1.0  # é‡è¯•å»¶è¿Ÿï¼ˆç§’ï¼‰

    # æ•°æ®éªŒè¯
    validation:
      required_fields: ["exchange_name", "symbol_name", "volatility_index", "timestamp"]
      index_range_check: true
      min_index: 0.0      # æœ€å°æ³¢åŠ¨ç‡æŒ‡æ•°
      max_index: 500.0    # æœ€å¤§æ³¢åŠ¨ç‡æŒ‡æ•°

    # å‘Šè­¦é…ç½®
    alerts:
      high_volatility_threshold: 100.0  # é«˜æ³¢åŠ¨ç‡é˜ˆå€¼

# ğŸ”§ æ–°å¢ï¼šå­˜å‚¨é…ç½®ï¼ˆä»data_collection_config.ymlè¿ç§»ï¼‰
storage:
  buffer_size: 1000
  batch_size: 100
  flush_interval: 10  # ç§’
  compression_enabled: true

# ğŸ”§ æ–°å¢ï¼šäº¤æ˜“ç­–ç•¥é…ç½®ï¼ˆä»trading_strategies.yamlè¿ç§»ï¼‰
trading_strategies:
  # é»˜è®¤ç­–ç•¥é…ç½®
  default:
    depth_config:
      exchanges:
        binance:
          spot:
            snapshot_depth: 1000
            websocket_depth: 1000
            api_weight: 10
            update_frequency: "100ms"
          perpetual:
            snapshot_depth: 1000
            websocket_depth: 1000
            api_weight: 10
            update_frequency: "100ms"
        okx:
          spot:
            snapshot_depth: 400
            websocket_depth: 400
            api_weight: 5
            update_frequency: "100ms"
          perpetual:
            snapshot_depth: 400
            websocket_depth: 400
            api_weight: 5
            update_frequency: "100ms"

    performance_config:
      snapshot_interval: 60
      max_latency_ms: 1000
      error_tolerance: "medium"

  # é«˜é¢‘äº¤æ˜“ç­–ç•¥
  high_frequency:
    depth_config:
      exchanges:
        binance:
          spot:
            snapshot_depth: 100
            websocket_depth: 100
            api_weight: 5
            update_frequency: "10ms"
        okx:
          spot:
            snapshot_depth: 100
            websocket_depth: 100
            api_weight: 3
            update_frequency: "10ms"

    performance_config:
      snapshot_interval: 10
      max_latency_ms: 100
      error_tolerance: "strict"
