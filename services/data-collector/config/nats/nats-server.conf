# NATS Server Configuration for MarketPrism
# 项目配置文件 - 用于开发和生产环境

# =============================================================================
# 基础连接配置
# =============================================================================
host: 127.0.0.1
port: 4222

# =============================================================================
# 日志配置
# =============================================================================
# 生产环境: /var/log/nats-server.log
# Docker环境: /app/logs/nats-server.log 或 stdout
# 开发环境: ./logs/nats-server.log
log_file: "/var/log/nats-server.log"
logtime: true
debug: false
trace: false

# 日志级别通过debug和trace字段控制
# Docker部署时建议使用stdout: 注释掉log_file行即可

# =============================================================================
# 连接和性能限制
# =============================================================================
# 最大连接数
max_connections: 1000

# 最大控制行长度 (4KB)
max_control_line: 4096

# 最大消息负载 (1MB)
max_payload: 1048576

# 最大待处理字节数 (64MB)
max_pending: 67108864

# 写入超时 (2秒)
write_deadline: "2s"

# =============================================================================
# JetStream配置 - 持久化消息存储
# =============================================================================
jetstream {
    # 存储目录
    store_dir: "/var/lib/nats/jetstream"
    
    # 最大内存使用 (256MB)
    max_memory_store: 268435456
    
    # 最大文件存储 (10GB)
    max_file_store: 10737418240
    
    # 同步间隔 (2分钟)
    sync_interval: "2m"
    
    # 同步到磁盘的间隔
}

# =============================================================================
# 监控配置
# =============================================================================
# HTTP监控端口
http_port: 8222

# 监控路径
http_base_path: "/"

# =============================================================================
# 系统账户配置 (可选)
# =============================================================================
# 如果需要多租户或高级权限控制，可以启用系统账户
# system_account: "SYS"

# =============================================================================
# 认证配置 (可选)
# =============================================================================
# 如果需要认证，可以启用以下配置
# authorization {
#     # 用户认证
#     user: "marketprism"
#     password: "your_secure_password_here"
#     
#     # 或者使用令牌认证
#     # token: "your_secure_token_here"
#     
#     # 权限配置
#     permissions: {
#         publish: {
#             allow: ["orderbook-data.>", "trade-data.>", "funding-rate-data.>", 
#                    "open-interest-data.>", "liquidation-orders.>"]
#         }
#         subscribe: {
#             allow: ["orderbook-data.>", "trade-data.>", "funding-rate-data.>", 
#                    "open-interest-data.>", "liquidation-orders.>"]
#         }
#     }
# }

# =============================================================================
# 集群配置 (多节点部署时使用)
# =============================================================================
# cluster {
#     name: "marketprism-cluster"
#     listen: 127.0.0.1:6222
#     
#     # 集群路由
#     routes: [
#         nats-route://127.0.0.1:6222
#     ]
#     
#     # 集群权限
#     authorization {
#         user: cluster_user
#         password: cluster_password
#         timeout: 2
#     }
# }

# =============================================================================
# TLS配置 (生产环境推荐)
# =============================================================================
# tls {
#     cert_file: "/path/to/server-cert.pem"
#     key_file: "/path/to/server-key.pem"
#     ca_file: "/path/to/ca.pem"
#     verify: true
#     timeout: 5
# }

# =============================================================================
# 性能优化配置
# =============================================================================
# 这些限制已在上面的全局配置中设置
