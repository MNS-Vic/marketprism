# MarketPrism Data Storage Service 环境变量配置
# 🔄 Docker部署简化改造版本 (2025-08-02)

# ==================== 基础配置 ====================
LOG_LEVEL=INFO
PYTHONUNBUFFERED=1

# ==================== NATS配置 ====================
# 连接到统一NATS容器
MARKETPRISM_NATS_SERVERS=nats://localhost:4222
MARKETPRISM_NATS_ENABLED=true

# ==================== ClickHouse热存储配置 ====================
# ClickHouse连接配置
CLICKHOUSE_HOST=clickhouse-hot
CLICKHOUSE_HTTP_PORT=8123
CLICKHOUSE_TCP_PORT=9000
CLICKHOUSE_DATABASE=marketprism_hot
CLICKHOUSE_USER=default
CLICKHOUSE_PASSWORD=

# ClickHouse性能配置
CLICKHOUSE_MAX_MEMORY_USAGE=10000000000
CLICKHOUSE_MAX_EXECUTION_TIME=300

# ==================== 服务配置 ====================
# 热存储服务端口
STORAGE_SERVICE_PORT=8080
MARKETPRISM_STORAGE_SERVICE_HOST=0.0.0.0
MARKETPRISM_STORAGE_SERVICE_PORT=8080

# ==================== 数据处理配置 ====================
# 批量处理配置
BATCH_SIZE=1000
FLUSH_INTERVAL=5
MAX_WAIT_TIME=30

# 数据验证配置
VALIDATION_ENABLED=true
STRICT_MODE=false

# 错误处理配置
MAX_RETRIES=3
RETRY_DELAY=1.0

# ==================== 监控配置 ====================
# 健康检查配置
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=30

# 指标收集配置
METRICS_ENABLED=true
METRICS_ENDPOINT=/metrics

# 统计信息配置
STATS_ENABLED=true
STATS_UPDATE_INTERVAL=60

# ==================== 性能优化配置 ====================
# 并发配置
MAX_WORKERS=10
QUEUE_SIZE=1000

# 内存管理配置
MAX_MEMORY_MB=1024
GC_THRESHOLD=0.8

# 缓存配置
CACHE_ENABLED=true
CACHE_SIZE=10000
CACHE_TTL=300

# ==================== 数据库配置 ====================
# 数据保留配置
HOT_DATA_TTL=3600        # 热存储TTL（1小时）
COLD_DATA_TTL=2592000    # 冷存储TTL（30天）
ARCHIVE_THRESHOLD_DAYS=7  # 归档阈值

# 分区和压缩配置
PARTITION_BY=toYYYYMM(timestamp)
COMPRESSION_CODEC=LZ4
ENABLE_COMPRESSION=true

# ==================== 安全配置 ====================
# 访问控制配置
ACCESS_CONTROL_ENABLED=false
ALLOWED_IPS=
BLOCKED_IPS=

# API认证配置
API_AUTH_ENABLED=false
API_KEY=

# ==================== 开发配置 ====================
# 调试配置
DEBUG_MODE=false
VERBOSE_LOGGING=false

# 测试配置
TEST_MODE=false
MOCK_DATA_ENABLED=false

# ==================== Docker配置 ====================
# 容器配置
CONTAINER_NAME=marketprism-hot-storage-service
RESTART_POLICY=unless-stopped

# 网络配置
NETWORK_NAME=marketprism-storage-network

# 数据卷配置
VOLUME_NAME=marketprism-clickhouse-hot-data

# ==================== 使用说明 ====================
# 1. 复制此文件为 .env
# 2. 根据实际环境修改配置值
# 3. 启动服务：docker-compose -f docker-compose.hot-storage.yml up -d
# 4. 查看日志：docker-compose -f docker-compose.hot-storage.yml logs -f
# 5. 健康检查：curl http://localhost:8080/health
