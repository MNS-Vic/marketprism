# MarketPrism NATS Server é…ç½®æ–‡ä»¶
# ğŸ”„ Dockeréƒ¨ç½²ç®€åŒ–æ”¹é€ ç‰ˆæœ¬ (2025-08-02)

# æœåŠ¡å™¨åŸºæœ¬é…ç½®
server_name: "marketprism-nats-unified"
host: "0.0.0.0"
port: 4222

# HTTPç›‘æ§ç«¯å£
http_port: 8222

# æ—¥å¿—é…ç½®
log_file: "/var/log/nats/nats.log"
logtime: true
debug: false
trace: false

# è¿æ¥é…ç½®
max_connections: 64K
max_control_line: 4KB
max_payload: 1MB
max_pending: 64MB
ping_interval: "2m"
ping_max: 2

# å†™å…¥è¶…æ—¶é…ç½®
write_deadline: "10s"

# è®¤è¯é…ç½®ï¼ˆå¼€å‘ç¯å¢ƒæš‚æ—¶å…³é—­ï¼‰
# authorization {
#     user: "marketprism"
#     password: "your_secure_password"
# }

# JetStreamé…ç½®
jetstream {
    # å­˜å‚¨ç›®å½•
    store_dir: "/data/jetstream"
    
    # æœ€å¤§å†…å­˜ä½¿ç”¨
    max_memory_store: 1GB
    
    # æœ€å¤§æ–‡ä»¶å­˜å‚¨
    max_file_store: 10GB
    
    # åŸŸé…ç½®
    domain: "marketprism"
}

# é›†ç¾¤é…ç½®ï¼ˆå•èŠ‚ç‚¹æ¨¡å¼ï¼‰
cluster {
    name: "marketprism-cluster"
    host: "0.0.0.0"
    port: 6222
    
    # è·¯ç”±é…ç½®
    routes = [
        # nats-route://nats-1:6222
        # nats-route://nats-2:6222
    ]
    
    # é›†ç¾¤è®¤è¯
    # authorization {
    #     user: "cluster_user"
    #     password: "cluster_password"
    # }
}

# ç³»ç»Ÿè´¦æˆ·é…ç½®
system_account: "$SYS"

# è´¦æˆ·é…ç½®
accounts {
    # ç³»ç»Ÿè´¦æˆ·
    $SYS {
        users = [
            { user: "admin", pass: "admin" }
        ]
    }
    
    # MarketPrismåº”ç”¨è´¦æˆ·
    MARKETPRISM {
        users = [
            { 
                user: "marketprism_user", 
                pass: "marketprism_pass",
                permissions: {
                    publish: {
                        allow: [">"]
                    }
                    subscribe: {
                        allow: [">"]
                    }
                }
            }
        ]
        
        # JetStreamé…ç½®
        jetstream: {
            max_memory: 512MB
            max_file: 5GB
            max_streams: 100
            max_consumers: 1000
        }
    }
}

# é»˜è®¤è´¦æˆ·
no_auth_user: "marketprism_user"

# æ€§èƒ½ä¼˜åŒ–é…ç½®
# æœ€å¤§è®¢é˜…æ•°
max_subscriptions: 0

# æœ€å¤§è´Ÿè½½
max_payload: 1MB

# æ…¢æ¶ˆè´¹è€…é…ç½®
slow_consumer_threshold: "1s"

# ç›‘æ§é…ç½®
monitoring {
    # HTTPç›‘æ§ç«¯ç‚¹
    http_port: 8222
    
    # ç›‘æ§è·¯å¾„
    # /varz - æœåŠ¡å™¨å˜é‡
    # /connz - è¿æ¥ä¿¡æ¯
    # /routez - è·¯ç”±ä¿¡æ¯
    # /subsz - è®¢é˜…ä¿¡æ¯
    # /stacksz - å †æ ˆä¿¡æ¯
}

# é™åˆ¶é…ç½®
limits {
    # æœ€å¤§è¿æ¥æ•°
    max_connections: 64K
    
    # æœ€å¤§è®¢é˜…æ•°
    max_subscriptions: 0
    
    # æœ€å¤§è´Ÿè½½
    max_payload: 1MB
    
    # æœ€å¤§æ§åˆ¶è¡Œ
    max_control_line: 4KB
    
    # æœ€å¤§æŒ‚èµ·å­—èŠ‚æ•°
    max_pending: 64MB
}

# TLSé…ç½®ï¼ˆç”Ÿäº§ç¯å¢ƒå¯ç”¨ï¼‰
# tls {
#     cert_file: "/etc/nats/certs/server.crt"
#     key_file: "/etc/nats/certs/server.key"
#     ca_file: "/etc/nats/certs/ca.crt"
#     verify: true
#     timeout: 5
# }

# ç½‘å…³é…ç½®ï¼ˆå¤šé›†ç¾¤è¿æ¥ï¼‰
# gateway {
#     name: "marketprism-gateway"
#     host: "0.0.0.0"
#     port: 7222
#     
#     gateways: [
#         {
#             name: "remote-cluster"
#             urls: ["nats://remote-nats:7222"]
#         }
#     ]
# }

# LeafèŠ‚ç‚¹é…ç½®ï¼ˆè¾¹ç¼˜èŠ‚ç‚¹ï¼‰
# leafnodes {
#     host: "0.0.0.0"
#     port: 7422
#     
#     remotes: [
#         {
#             url: "nats://hub-nats:7422"
#         }
#     ]
# }

# WebSocketé…ç½®
# websocket {
#     host: "0.0.0.0"
#     port: 8080
#     no_tls: true
# }

# è°ƒè¯•å’Œå¼€å‘é…ç½®
# debug: true
# trace: true
# logtime: true
# log_file: "/var/log/nats/nats.log"

# ä¼˜é›…å…³é—­é…ç½®
# lame_duck_duration: "2m"
# lame_duck_grace_period: "10s"
