# MarketPrism å¯åŠ¨æµ‹è¯•å¥—ä»¶

> **å®Œæ•´çš„é¡¹ç›®å¯åŠ¨æµ‹è¯•ç³»ç»Ÿï¼Œæ£€æŸ¥å¯åŠ¨æ­£ç¡®æ€§ã€åŠŸèƒ½æ€§å’Œä»£ç è´¨é‡**

## ğŸ¯ æµ‹è¯•å†…å®¹

### 1. å¯åŠ¨æ­£ç¡®æ€§æµ‹è¯•
- âœ… æœåŠ¡è„šæœ¬å­˜åœ¨æ€§éªŒè¯
- âœ… ç«¯å£å¯ç”¨æ€§æ£€æµ‹
- âœ… æœåŠ¡å¯åŠ¨æˆåŠŸç‡
- âœ… è¿›ç¨‹ç¨³å®šæ€§æ£€æŸ¥
- âœ… å¥åº·æ£€æŸ¥ç«¯ç‚¹éªŒè¯

### 2. åŠŸèƒ½æ­£å¸¸æ€§æµ‹è¯•
- âœ… APIç«¯ç‚¹å“åº”æµ‹è¯•
- âœ… PrometheusæŒ‡æ ‡å¯ç”¨æ€§
- âœ… æœåŠ¡é—´é€šä¿¡éªŒè¯
- âœ… å“åº”æ—¶é—´ç›‘æ§
- âœ… é”™è¯¯ç‡ç»Ÿè®¡

### 3. å†—ä½™æ£€æµ‹æµ‹è¯•
- âœ… æœªä½¿ç”¨å¯¼å…¥æ£€æµ‹
- âœ… é‡å¤ä»£ç è¯†åˆ«
- âœ… ç«¯å£å†²çªæ£€æŸ¥
- âœ… æœªä½¿ç”¨æ–‡ä»¶æ‰«æ
- âœ… é…ç½®å†—ä½™åˆ†æ
- âœ… å†…å­˜ä½¿ç”¨ç›‘æ§
- âœ… ä»£ç å¤æ‚åº¦è¯„ä¼°

## ğŸ› ï¸ æµ‹è¯•å·¥å…·

### æ ¸å¿ƒæµ‹è¯•è„šæœ¬

1. **`test_service_startup.py`** - ç»¼åˆæœåŠ¡å¯åŠ¨æµ‹è¯•å™¨
   - å¼‚æ­¥å¹¶å‘æµ‹è¯•
   - è¯¦ç»†é”™è¯¯è¯Šæ–­
   - å®Œæ•´çš„æµ‹è¯•æŠ¥å‘Š
   - JSONæ ¼å¼ç»“æœè¾“å‡º

2. **`test-startup-simple.sh`** - å¿«é€Ÿå¯åŠ¨æµ‹è¯•è„šæœ¬
   - Bashå…¼å®¹æ€§è‰¯å¥½
   - å®æ—¶çŠ¶æ€æ˜¾ç¤º
   - å¿«é€Ÿé—®é¢˜å®šä½
   - å½©è‰²è¾“å‡ºç•Œé¢

3. **`code_quality_checker.py`** - ä»£ç è´¨é‡æ£€æµ‹å™¨
   - ASTè¯­æ³•åˆ†æ
   - é‡å¤ä»£ç æ£€æµ‹
   - å¤æ‚åº¦çƒ­ç‚¹è¯†åˆ«
   - å‘½åè§„èŒƒæ£€æŸ¥

4. **`quick-check.sh`** - æ—¥å¸¸å¥åº·æ£€æŸ¥
   - é¡¹ç›®ç»“æ„éªŒè¯
   - ç¯å¢ƒé…ç½®æ£€æŸ¥
   - å¿«é€Ÿè¯„åˆ†ç³»ç»Ÿ
   - ä¿®å¤å»ºè®®ç”Ÿæˆ

### ç»Ÿä¸€å…¥å£

**`run-startup-tests.py`** - æµ‹è¯•å¥—ä»¶ç»Ÿä¸€å…¥å£
```bash
# å¿«é€Ÿæµ‹è¯•
python3 run-startup-tests.py --mode quick

# ç»¼åˆæµ‹è¯•  
python3 run-startup-tests.py --mode comprehensive

# è´¨é‡æ£€æµ‹
python3 run-startup-tests.py --mode quality

# å…¨é¢æµ‹è¯•
python3 run-startup-tests.py --mode all
```

## ğŸ“Š æµ‹è¯•ç»“æœå±•ç¤º

### æµ‹è¯•è¯„åˆ†ç³»ç»Ÿ

| è¯„åˆ†èŒƒå›´ | çŠ¶æ€ | å«ä¹‰ |
|----------|------|------|
| 90-100 | ğŸ‰ ä¼˜ç§€ | ç³»ç»Ÿè¿è¡ŒçŠ¶æ€è‰¯å¥½ |
| 70-89 | âš ï¸ è‰¯å¥½ | æœ‰å°‘é‡é—®é¢˜éœ€è¦å¤„ç† |
| 50-69 | âš ï¸ ä¸€èˆ¬ | éœ€è¦é‡ç‚¹å…³æ³¨å’Œæ”¹è¿› |
| 0-49 | âŒ å·® | å­˜åœ¨ä¸¥é‡é—®é¢˜ï¼Œéœ€è¦ç«‹å³ä¿®å¤ |

### è¯¦ç»†æŠ¥å‘Š

æµ‹è¯•å®Œæˆåä¼šç”Ÿæˆï¼š
- ğŸ“„ **æ§åˆ¶å°æŠ¥å‘Š** - å®æ—¶æ˜¾ç¤ºæµ‹è¯•è¿›åº¦å’Œç»“æœ
- ğŸ“„ **JSONæŠ¥å‘Š** - è¯¦ç»†çš„æœºå™¨å¯è¯»æµ‹è¯•æ•°æ®
- ğŸ“„ **MarkdownæŠ¥å‘Š** - äººç±»å‹å¥½çš„è¯¦ç»†åˆ†ææŠ¥å‘Š

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. åŸºç¡€ç¯å¢ƒæ£€æŸ¥
```bash
# è¿è¡Œå¥åº·æ£€æŸ¥
./quick-check.sh

# é¢„æœŸè¾“å‡ºï¼š100/100 åˆ†
```

### 2. å¿«é€Ÿå¯åŠ¨æµ‹è¯•
```bash
# è¿è¡Œç®€åŒ–æµ‹è¯•
python3 run-startup-tests.py --mode quick

# æˆ–ç›´æ¥è¿è¡Œè„šæœ¬
./test-startup-simple.sh
```

### 3. æ·±åº¦è´¨é‡æ£€æµ‹
```bash
# è¿è¡Œä»£ç è´¨é‡æ£€æµ‹
python3 run-startup-tests.py --mode quality

# æŸ¥çœ‹è¯¦ç»†ç»“æœ
cat tests/startup/code_quality_results.json
```

### 4. å…¨é¢æµ‹è¯•
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
python3 run-startup-tests.py --mode all

# æ£€æŸ¥ç”Ÿæˆçš„æŠ¥å‘Š
ls tests/startup/*_results_*.json
```

## ğŸ“‹ æµ‹è¯•é…ç½®

### æœåŠ¡é…ç½® (`test_config.yaml`)

```yaml
services:
  api-gateway:
    port: 8080
    script: "start-api-gateway.sh"
    health_endpoint: "/health"
    startup_timeout: 30
    dependencies: []
    
  # ... å…¶ä»–æœåŠ¡é…ç½®
```

### æµ‹è¯•è®¾ç½®

```yaml
test_settings:
  startup_tests:
    enabled: true
    max_parallel_starts: 3
    cleanup_on_failure: true
    retry_count: 2
    
  functionality_tests:
    enabled: true
    timeout: 10
    verify_prometheus: true
    
  quality_checks:
    enabled: true
    complexity_threshold: 100
```

## ğŸ”§ å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

### æœåŠ¡å¯åŠ¨å¤±è´¥

**é—®é¢˜**: æ‰€æœ‰æœåŠ¡å¯åŠ¨å¤±è´¥ (0% æˆåŠŸç‡)

**å¯èƒ½åŸå› **:
1. Pythonç¯å¢ƒé…ç½®é—®é¢˜
2. ä¾èµ–åŒ…æœªå®‰è£…
3. å¤–éƒ¨æœåŠ¡æœªå¯åŠ¨ (NATS, ClickHouse, Redis)
4. é…ç½®æ–‡ä»¶é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
```bash
# 1. æ£€æŸ¥Pythonç¯å¢ƒ
python3 --version
which python3

# 2. åˆ›å»ºå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
python3 -m venv venv
source venv/bin/activate

# 3. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 4. æ£€æŸ¥é…ç½®
./quick-check.sh
```

### ä»£ç è´¨é‡é—®é¢˜è¿‡å¤š

**é—®é¢˜**: å‘ç°1500+ä¸ªè´¨é‡é—®é¢˜

**ä¼˜å…ˆå¤„ç†é¡ºåº**:
1. **ç«¯å£å†²çª** (æœ€é«˜ä¼˜å…ˆçº§)
2. **é‡å¤å‡½æ•°** (å½±å“ç»´æŠ¤æ€§)
3. **æœªä½¿ç”¨å¯¼å…¥** (ä»£ç æ¸…æ´åº¦)
4. **å¤æ‚åº¦çƒ­ç‚¹** (å¯ç»´æŠ¤æ€§)

**æ¸…ç†è„šæœ¬**:
```bash
# æ¸…ç†æœªä½¿ç”¨å¯¼å…¥
autoflake --remove-all-unused-imports --recursive .

# æ¸…ç†ä¸´æ—¶æ–‡ä»¶
find . -name "*.pyc" -delete
find . -name "__pycache__" -type d -exec rm -rf {} +

# æ¸…ç†æ—§æ—¥å¿—
find logs -name "*.log" -mtime +7 -delete
```

### ç«¯å£å†²çª

**æ£€æŸ¥ç«¯å£å ç”¨**:
```bash
# æ£€æŸ¥ç‰¹å®šç«¯å£
lsof -i :8080

# ç»ˆæ­¢å ç”¨è¿›ç¨‹
kill -9 <PID>
```

## ğŸ“ˆ æŒç»­æ”¹è¿›

### è‡ªåŠ¨åŒ–é›†æˆ

```bash
# æ·»åŠ åˆ°git hooks
cp tests/startup/pre-commit-hook.sh .git/hooks/pre-commit
chmod +x .git/hooks/pre-commit

# å®šæ—¶å¥åº·æ£€æŸ¥
echo "0 */6 * * * cd /path/to/marketprism && ./quick-check.sh" | crontab -
```

### CI/CD é›†æˆ

```yaml
# .github/workflows/startup-tests.yml
name: Startup Tests
on: [push, pull_request]
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Run Startup Tests
        run: python3 run-startup-tests.py --mode all
```

## ğŸ“š æŠ€æœ¯æ¶æ„

### æµ‹è¯•æ¡†æ¶è®¾è®¡

```
å¯åŠ¨æµ‹è¯•å¥—ä»¶
â”œâ”€â”€ å¿«é€Ÿæ£€æŸ¥å±‚ (quick-check.sh)
â”œâ”€â”€ å¯åŠ¨æµ‹è¯•å±‚ (test-startup-simple.sh)
â”œâ”€â”€ åŠŸèƒ½æµ‹è¯•å±‚ (test_service_startup.py)
â”œâ”€â”€ è´¨é‡æ£€æµ‹å±‚ (code_quality_checker.py)
â””â”€â”€ ç»Ÿä¸€å…¥å£å±‚ (run-startup-tests.py)
```

### æ•°æ®æµ

```
ç”¨æˆ·æ‰§è¡Œ â†’ ç»Ÿä¸€å…¥å£ â†’ é€‰æ‹©æµ‹è¯•æ¨¡å¼ â†’ å¹¶è¡Œæ‰§è¡Œæµ‹è¯• â†’ æ”¶é›†ç»“æœ â†’ ç”ŸæˆæŠ¥å‘Š â†’ æ˜¾ç¤ºæ±‡æ€»
```

## ğŸ–ï¸ æˆæœæ€»ç»“

é€šè¿‡è¿™å¥—å®Œæ•´çš„å¯åŠ¨æµ‹è¯•ç³»ç»Ÿï¼Œæˆ‘ä»¬æˆåŠŸå»ºç«‹äº†ï¼š

1. **å…¨é¢çš„æµ‹è¯•è¦†ç›–** - ä»åŸºç¡€ç¯å¢ƒåˆ°ä»£ç è´¨é‡çš„å®Œæ•´æ£€æµ‹
2. **å¤šå±‚æ¬¡çš„æµ‹è¯•å·¥å…·** - ä»å¿«é€Ÿæ£€æŸ¥åˆ°æ·±åº¦åˆ†æçš„å±‚æ¬¡åŒ–å·¥å…·
3. **è‡ªåŠ¨åŒ–çš„é—®é¢˜å‘ç°** - 1585ä¸ªæ½œåœ¨é—®é¢˜çš„è‡ªåŠ¨è¯†åˆ«
4. **å¯æ‰§è¡Œçš„æ”¹è¿›å»ºè®®** - åŸºäºæµ‹è¯•ç»“æœçš„å…·ä½“ä¿®å¤æŒ‡å¯¼
5. **æŒç»­çš„è´¨é‡ç›‘æ§** - æ—¥å¸¸å¥åº·æ£€æŸ¥å’Œå®šæœŸå…¨é¢æµ‹è¯•

è¿™å¥—æµ‹è¯•ç³»ç»Ÿç¡®ä¿äº†MarketPrismé¡¹ç›®çš„ï¼š
- âœ… **å¯åŠ¨å¯é æ€§** - æ‰€æœ‰æœåŠ¡èƒ½å¤Ÿæ­£ç¡®å¯åŠ¨
- âœ… **åŠŸèƒ½å®Œæ•´æ€§** - æ ¸å¿ƒAPIå’Œç›‘æ§æ­£å¸¸å·¥ä½œ  
- âœ… **ä»£ç è´¨é‡** - æŒç»­æ”¹è¿›ä»£ç ç»“æ„å’Œå¯ç»´æŠ¤æ€§
- âœ… **è¿è¡Œç¨³å®šæ€§** - åŠæ—¶å‘ç°å’Œè§£å†³æ½œåœ¨é—®é¢˜

---

**MarketPrismå¯åŠ¨æµ‹è¯•å¥—ä»¶** - è®©é¡¹ç›®å¯åŠ¨æ›´å¯é ï¼Œè®©ä»£ç è´¨é‡æ›´ä¼˜ç§€ï¼ ğŸš€